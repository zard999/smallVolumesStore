import{_ as s,c as n,o as a,a as l}from"./app.3aab1824.js";const i=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u524D\u8A00","slug":"\u524D\u8A00","link":"#\u524D\u8A00","children":[]},{"level":2,"title":"A. \u4E3A\u4EC0\u4E48\u8981\u5199 rc-redux-model","slug":"a-\u4E3A\u4EC0\u4E48\u8981\u5199-rc-redux-model","link":"#a-\u4E3A\u4EC0\u4E48\u8981\u5199-rc-redux-model","children":[{"level":3,"title":"1. \u51FA\u73B0\u7F18\u7531","slug":"_1-\u51FA\u73B0\u7F18\u7531","link":"#_1-\u51FA\u73B0\u7F18\u7531","children":[]},{"level":3,"title":"2. \u4F53\u9A8C\u4E0D\u4F73","slug":"_2-\u4F53\u9A8C\u4E0D\u4F73","link":"#_2-\u4F53\u9A8C\u4E0D\u4F73","children":[]},{"level":3,"title":"3. dva \u901F\u5FC3\u4E38\uFF1F","slug":"_3-dva-\u901F\u5FC3\u4E38\uFF1F","link":"#_3-dva-\u901F\u5FC3\u4E38\uFF1F","children":[]},{"level":3,"title":"4. \u81EA\u5DF1\u6240\u9700","slug":"_4-\u81EA\u5DF1\u6240\u9700","link":"#_4-\u81EA\u5DF1\u6240\u9700","children":[]}]},{"level":2,"title":"B. \u5982\u4F55\u5B9E\u73B0 rc-redux-model","slug":"b-\u5982\u4F55\u5B9E\u73B0-rc-redux-model","link":"#b-\u5982\u4F55\u5B9E\u73B0-rc-redux-model","children":[{"level":3,"title":"01. \u521D\u5EFA\u96CF\u5F62","slug":"_01-\u521D\u5EFA\u96CF\u5F62","link":"#_01-\u521D\u5EFA\u96CF\u5F62","children":[]},{"level":3,"title":"02. \u5F02\u6B65\u5904\u7406","slug":"_02-\u5F02\u6B65\u5904\u7406","link":"#_02-\u5F02\u6B65\u5904\u7406","children":[]},{"level":3,"title":"03. \u63D0\u9AD8\u4F53\u9A8C","slug":"_03-\u63D0\u9AD8\u4F53\u9A8C","link":"#_03-\u63D0\u9AD8\u4F53\u9A8C","children":[]},{"level":3,"title":"04. \u6570\u636E\u4E0D\u53EF\u53D8","slug":"_04-\u6570\u636E\u4E0D\u53EF\u53D8","link":"#_04-\u6570\u636E\u4E0D\u53EF\u53D8","children":[]},{"level":3,"title":"05. \u5904\u7406\u7C7B\u578B\u4E0D\u4E00\u81F4","slug":"_05-\u5904\u7406\u7C7B\u578B\u4E0D\u4E00\u81F4","link":"#_05-\u5904\u7406\u7C7B\u578B\u4E0D\u4E00\u81F4","children":[]},{"level":3,"title":"C. \u6838\u5FC3\u6E90\u7801\u89E3\u8BFB","slug":"c-\u6838\u5FC3\u6E90\u7801\u89E3\u8BFB","link":"#c-\u6838\u5FC3\u6E90\u7801\u89E3\u8BFB","children":[]},{"level":3,"title":"\u7ED3\u5408 rc-redux-model \u6E90\u7801","slug":"\u7ED3\u5408-rc-redux-model-\u6E90\u7801","link":"#\u7ED3\u5408-rc-redux-model-\u6E90\u7801","children":[]}]},{"level":2,"title":"\u6700\u540E","slug":"\u6700\u540E","link":"#\u6700\u540E","children":[]}],"relativePath":"electron/28.\u5F69\u86CB\u7BC7-RcReduxModel\u4E2D\u95F4\u4EF6\u5F00\u53D1\u8BBE\u8BA1.md"}'),p={name:"electron/28.\u5F69\u86CB\u7BC7-RcReduxModel\u4E2D\u95F4\u4EF6\u5F00\u53D1\u8BBE\u8BA1.md"},o=l(`<h2 id="\u524D\u8A00" tabindex="-1">\u524D\u8A00 <a class="header-anchor" href="#\u524D\u8A00" aria-hidden="true">#</a></h2><p>\u672C\u7AE0\u8282\u5C06\u4F1A\u7ED9\u5927\u5BB6\u5206\u4EAB <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FSugarTurboS%2Frc-redux-model" target="_blank" rel="noreferrer">re-redux-model</a> \u7684\u51FA\u73B0\u7F18\u7531\u4EE5\u53CA\u8BBE\u8BA1\u8FC7\u7A0B\uFF0C\u5F53\u7136\u8FD8\u6709\u6838\u5FC3\u6E90\u7801\u7684\u89E3\u8BFB\uFF0C\u5982\u679C\u4F60\u5BF9\u672C\u7AE0\u8282\u5185\u5BB9\u5174\u8DA3\u4E0D\u5927\uFF0C\u53EF\u4EE5\u5FEB\u901F\u9605\u8BFB\u6216\u8DF3\u8FC7\u3002</p><p>\u672C\u6587\u7684\u6574\u4F53\u601D\u8DEF\uFF1A</p><ul><li>\u4E3A\u4EC0\u4E48\u8981\u5199 rc-redux-model</li><li>\u6211\u671F\u671B\u505A\u6210\u4EC0\u4E48\u6837</li><li>\u77E5\u8BC6\u50A8\u5907</li><li>\u6838\u5FC3\u6E90\u7801\u89E3\u8BFB</li></ul><h2 id="a-\u4E3A\u4EC0\u4E48\u8981\u5199-rc-redux-model" tabindex="-1">A. \u4E3A\u4EC0\u4E48\u8981\u5199 rc-redux-model <a class="header-anchor" href="#a-\u4E3A\u4EC0\u4E48\u8981\u5199-rc-redux-model" aria-hidden="true">#</a></h2><h3 id="_1-\u51FA\u73B0\u7F18\u7531" tabindex="-1">1. \u51FA\u73B0\u7F18\u7531 <a class="header-anchor" href="#_1-\u51FA\u73B0\u7F18\u7531" aria-hidden="true">#</a></h3><p>\u524D\u9762\u7ED9\u5927\u5BB6\u4E0D\u65AD\u5F3A\u8C03\uFF0C<strong>React \u662F\u5355\u5411\u6570\u636E\u6D41\u7684\u5F62\u5F0F</strong>\uFF0C\u5B83\u4E0D\u5B58\u5728\u6570\u636E\u5411\u4E0A\u56DE\u6EAF\u7684\u6280\u80FD\uFF0C\u8981\u4E48\u5C31\u662F\u5411\u4E0B\u5206\u53D1\uFF0C\u8981\u4E48\u5C31\u662F\u81EA\u5DF1\u5185\u90E8\u7BA1\u7406\u3002</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ec1c1df7d3594a7cae3e702aaddbfdd1~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="image.png"></p><blockquote><p>\u5728 react \u4E2D\uFF0C\u6709 props \u548C state\uFF0C\u5F53\u6211\u60F3\u4ECE\u7236\u7EC4\u4EF6\u7ED9\u5B50\u7EC4\u4EF6\u4F20\u9012\u6570\u636E\u65F6\uFF0C\u53EF\u901A\u8FC7 props \u8FDB\u884C\u6570\u636E\u4F20\u9012\uFF0C\u5982\u679C\u6211\u60F3\u5728\u7EC4\u4EF6\u5185\u90E8\u81EA\u884C\u7BA1\u7406\u72B6\u6001\uFF0C\u90A3\u53EF\u4EE5\u9009\u62E9\u4F7F\u7528 state\u3002</p></blockquote><p>\u5F88\u5FEB\uFF0C\u6211\u9047\u5230\u4E86\u4E00\u4E2A\u95EE\u9898\uFF0C\u90A3\u5C31\u662F\u5144\u5F1F\u7EC4\u4EF6\u4E4B\u95F4\u5982\u4F55\u8FDB\u884C\u901A\u4FE1\uFF1F\u7B54\u6848\u662F\u5728\u7236\u7EC4\u4EF6\u4E2D\u7BA1\u7406 state\uFF0C\u901A\u8FC7 props \u4E0B\u53D1\u7ED9\u5404\u5B50\u7EC4\u4EF6\uFF0C\u5B50\u7EC4\u4EF6\u901A\u8FC7\u56DE\u8C03\u65B9\u5F0F\uFF0C\u8FDB\u884C\u901A\u4FE1\u3002</p><p>\u8FD9\u4F1A\u5B58\u5728\u4EC0\u4E48\u95EE\u9898\uFF1F\u5982\u679C\u4F60\u60F3\u5171\u4EAB\u6570\u636E\uFF0C\u4F60\u5F97\u628A\u6240\u6709\u9700\u8981\u5171\u4EAB\u7684 state \u96C6\u4E2D\u653E\u5230\u7EC4\u4EF6\u9876\u5C42\uFF0C\u7136\u540E\u5206\u53D1\u7ED9\u6240\u6709\u5B50\u7EC4\u4EF6\u3002\u4E3A\u6B64\uFF0C\u9700\u8981\u4E00\u4E2A\u5E93\u6765\u4F5C\u4E3A\u66F4\u52A0\u725B\u903C\u3001\u4E13\u4E1A\u7684\u9876\u5C42 state \u53D1\u7ED9\u5404\u7EC4\u4EF6\uFF0C\u4E8E\u662F\uFF0C\u6211\u5F15\u5165\u4E86 redux\u3002</p><h3 id="_2-\u4F53\u9A8C\u4E0D\u4F73" tabindex="-1">2. \u4F53\u9A8C\u4E0D\u4F73 <a class="header-anchor" href="#_2-\u4F53\u9A8C\u4E0D\u4F73" aria-hidden="true">#</a></h3><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freduxjs%2Fredux" target="_blank" rel="noreferrer">redux</a> \u53EF\u4EE5\u8BF4\u662F\u8F83\u6210\u719F\uFF0C\u751F\u6001\u5708\u8F83\u5B8C\u5584\u7684\u4E00\u4E2A\u5E93\u4E86\uFF0C\u642D\u914D <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fzalmoxisus%2Fredux-devtools-extension" target="_blank" rel="noreferrer">redux-devtools-extension</a> \u8FD9\u4E2A chrome \u63D2\u4EF6\uFF0C\u8BA9\u4F60\u5F00\u53D1\u66F4\u52A0\u5FEB\u4E50\u3002\u7136\uFF0C\u4E16\u95F4\u4E07\u7269\uFF0C\u7686\u6709\u5229\u5F0A\u3002</p><p>\u672C\u8EAB\u6211\u4F7F\u7528 redux \u4E0D\u4F1A\u6709\u6240\u8C13\u7684\u201C\u75DB\u70B9\u201D\uFF0C<strong>\u56E0\u4E3A redux \u9ED8\u8BA4\u53EA\u652F\u6301\u540C\u6B65\u64CD\u4F5C\uFF0C\u8BA9\u4F7F\u7528\u8005\u81EA\u884C\u9009\u62E9\u5904\u7406\u5F02\u6B65\uFF0C\u5BF9\u4E8E\u5F02\u6B65\u8BF7\u6C42 redux \u662F\u65E0\u80FD\u4E3A\u529B\u7684</strong>\u3002\u8FD9\u4E48\u8BF4\u5427\uFF0C\u5B83\u4FDD\u8BC1\u81EA\u5DF1\u662F\u7EAF\u7CB9\u7684\uFF0C\u810F\u6D3B\u7D2F\u6D3B\u4E22\u7ED9\u522B\u4EBA\u53BB\u5E72\u3002</p><p>\u4E8E\u662F\u6211\u7684\u75DB\u70B9\u5728\u4E8E\uFF1A\u5982\u4F55\u5904\u7406\u5F02\u6B65\u8BF7\u6C42\uFF0C\u4E3A\u6B64\u6211\u4F7F\u7528\u4E86 redux-saga \u53BB\u89E3\u51B3\u5F02\u6B65\u95EE\u9898\uFF0C\u4F46\u662F\u5728\u4F7F\u7528 <code>redux</code> + <code>redux-saga</code> \u4E2D\uFF0C\u6211\u53D1\u73B0\uFF0C\u8FD9\u4F1A\u8BA9\u6211\u7684 <strong>[\u91CD\u590D\u6027]</strong> \u5DE5\u4F5C\u53D8\u591A(\u9010\u6B65\u664B\u5347 CV \u5DE5\u7A0B\u5E08)\uFF0C\u56E0\u4E3A\u5B83\u5728\u6211\u9879\u76EE\u4E2D\uFF0C\u4F1A\u5B58\u5728\u5570\u55E6\u7684\u6837\u677F\u4EE3\u7801\u3002</p><p>\u4E3E\u4E2A\u4F8B\u5B50\uFF1A\u5F02\u6B65\u8BF7\u6C42\uFF0C\u83B7\u53D6\u7528\u6237\u4FE1\u606F\uFF0C\u6211\u9700\u8981\u521B\u5EFA <code>saga/user.js</code>\u3001<code>reducers/user.js</code>\u3001\u4EE5\u53CA <code>action/user.js</code>\uFF0C\u4E3A\u4E86\u7EDF\u4E00\u7BA1\u7406 const\uFF0C\u6211\u53EF\u80FD\u8FD8\u4F1A\u6709\u4E00\u4E2A <code>const/user.js</code>\uFF0C\u7136\u540E\u5728\u8FD9\u4E9B\u6587\u4EF6\u4E4B\u95F4\u6765\u56DE\u5207\u6362\u3002\uFF08\u4EC0\u4E48\u73A9\u610F\uFF1F\uFF09</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// const/user.js</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> FETCH_USER_INFO </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">FETCH_USER_INFO</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> FETCH_USER_INFO_SUCCESS </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">FETCH_USER_INFO_SUCCESS</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;">// actions/user.js</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">fetchUserInfo</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">params</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">callback</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">FETCH_USER_INFO</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">params</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">callback</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;">// sagas/user.js</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">fetchUserInfoSaga</span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">params</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">callback</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">yield</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">call</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">fetch</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">callAPI</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    actionName</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">FETCH_USER_INFO</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">params</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">code</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">yield</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">put</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">FETCH_USER_INFO_SUCCESS</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      data</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">callback</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">callback</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">throw</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">msg</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;">// reducers/user.js</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">userReducer</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">switch</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">type</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">case</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">FETCH_USER_INFO_SUCCESS</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Immutable</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">userInfo</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\u8FD9\u79CD\u6837\u677F\u4EE3\u7801\uFF0C\u7B80\u76F4\u5C31\u662F CV \u64CD\u4F5C\uFF0C\u53EA\u9700\u590D\u5236\u4E00\u4EFD\uFF0C\u4FEE\u6539\u4E00\u4E0B\u6587\u4EF6\u540D\u3001\u53C2\u6570\u7B49\uFF0C\u5C31\u80FD\u5B9E\u73B0\u4E00\u4E2A\u8BF7\u6C42\u6D41\u7A0B\u3002\u5BF9\u6211\u4E2A\u4EBA\u800C\u8A00\uFF0C\u8FD9\u4F1A\u8BA9\u6211\u4E0D\u591F\u4E13\u6CE8\uFF0C\u5206\u6563\u7BA1\u7406 const\u3001action\u3001saga\u3001reducer \u4E00\u5957\u6D41\u7A0B\uFF0C\u9700\u8981\u4E0D\u65AD\u7684\u8DF3\u8DC3\u601D\u8DEF\u3002\u968F\u7740\u6587\u4EF6\u6570\u91CF\u53D8\u591A\uFF0C\u6211\u662F\u771F\u7684\u4E0D\u559C\u6B22\u5982\u6B64<code>\u7E41\u7410</code>\u7684\u6D41\u7A0B\uFF0C\u6709\u6CA1\u6709\u597D\u7684\u6846\u67B6\u80FD\u5E2E\u6211\u628A\u8FD9\u4E9B\u4E8B\u90FD\u505A\u5B8C\u5462\uFF1F</p><h3 id="_3-dva-\u901F\u5FC3\u4E38\uFF1F" tabindex="-1">3. dva \u901F\u5FC3\u4E38\uFF1F <a class="header-anchor" href="#_3-dva-\u901F\u5FC3\u4E38\uFF1F" aria-hidden="true">#</a></h3><blockquote><p>dva\uFF0C\u57FA\u4E8E redux \u548C redux-saga \u7684\u6570\u636E\u6D41\u65B9\u6848\uFF0C\u8BA9\u4F60\u5728\u4E00\u4E2A model \u6587\u4EF6\u4E2D\u5199\u6240\u6709\u7684 <code>action\u3001state\u3001effect\u3001reducers</code>\u7B49\uFF0C\u4E3A\u4E86\u7B80\u5316\u5F00\u53D1\u4F53\u9A8C\uFF0C\u5185\u7F6E\u4E86 react-router \u548C fetch**\u3002</p></blockquote><p>\u6211\u662F\u5982\u4F55\u770B\u5F85 dva \u7684\uFF1F\u4ECE\u5B98\u65B9\u58F0\u660E\u6765\u770B\uFF0Cdva \u662F\u57FA\u4E8E <code>redux</code> + <code>redux-saga</code> \u7684\u65B9\u6848\uFF0C\u53EA\u662F\u5728\u4F60\u5199\u7684\u65F6\u5019\uFF0C\u90FD\u5199\u5728\u4E00\u4E2A model \u6587\u4EF6\uFF0C\u7136\u540E\u5B83\u5E2E\u4F60\u505A\u4E00\u4E9B\u5904\u7406\uFF1B\u5176\u6B21\u5B83\u662F\u4E00\u4E2A\u6846\u67B6\uFF0C\u800C\u4E0D\u662F\u4E00\u4E2A\u5E93\uFF0C\u662F\u5426\u610F\u5473\u7740\uFF1A\u6211\u5728\u9879\u76EE\u5F00\u59CB\u4E4B\u524D\uFF0C\u6211\u5C31\u9700\u8981\u786E\u5B9A\u9879\u76EE\u7684\u67B6\u6784\u662F\u4E0D\u662F\u7528 dva\uFF0C\u5982\u679C\u5F00\u53D1\u4E00\u534A\uFF0C\u6211\u60F3\u6362\u6210 dva \u8FD9\u79CD\u72B6\u6001\u7BA1\u7406\u7684\u5199\u6CD5\uFF0C\u800C\u53BB\u5F15\u5165 dva \uFF0C\u662F\u5426\u4E0D\u5408\u7406\uFF1F\u518D\u6216\u8005\uFF0C\u6211\u53EA\u662F\u505A\u4E00\u4E9B demo\u3001\u5199\u70B9\u4E2A\u4EBA\u5C0F\u9879\u76EE\uFF0C\u4F46\u6211\u53C8\u60F3\u50CF\u5199 dva \u7684\u6570\u636E\u72B6\u6001\u7BA1\u7406 model \u90A3\u79CD\u65B9\u5F0F\uFF0C\u5F15\u5165 dva \u662F\u4E0D\u662F\u53CD\u800C\u53D8\u5F97\u7B28\u91CD\u5462\uFF1F</p><h3 id="_4-\u81EA\u5DF1\u6240\u9700" tabindex="-1">4. \u81EA\u5DF1\u6240\u9700 <a class="header-anchor" href="#_4-\u81EA\u5DF1\u6240\u9700" aria-hidden="true">#</a></h3><p>\u51FA\u53D1\u70B9\u4E3A\uFF1A\u5728\u4E8E\u89E3\u51B3\u7E41\u7410\u91CD\u590D\u7684\u5DE5\u4F5C\uFF0Cstore \u6587\u4EF6\u5206\u6563\uFF0Cstate \u7C7B\u578B\u548C\u8D4B\u503C\u9519\u8BEF\u7684\u95EE\u9898\uFF0C\u4E3A\u6B64\uFF0C\u6211\u671F\u671B\u4E3A\u8DDF\u6211\u4E00\u6837\u56F0\u60D1\u7684\u5C0F\u4F19\u4F34\uFF0C\u63D0\u4F9B\u4E00\u4E2A\u5199\u72B6\u6001\u7BA1\u7406\u8F83\u4E3A <strong>[\u8212\u670D]</strong> \u7684\u4E66\u5199\u65B9\u5F0F\uFF0C\u65E0\u7F1D\u517C\u5BB9\u539F\u6709\u9879\u76EE\uFF0C\u53EA\u9700\u8981\u5B89\u88C5\u8FD9\u4E2A\u5305\uFF0C\u5C31\u80FD\u5F15\u5165\u4E00\u5957\u6570\u636E\u7BA1\u7406\u65B9\u6848\uFF0C\u5199\u8D77\u6765\u53C8\u8212\u670D\u7B80\u6D01\u3002</p><h2 id="b-\u5982\u4F55\u5B9E\u73B0-rc-redux-model" tabindex="-1">B. \u5982\u4F55\u5B9E\u73B0 rc-redux-model <a class="header-anchor" href="#b-\u5982\u4F55\u5B9E\u73B0-rc-redux-model" aria-hidden="true">#</a></h2><h3 id="_01-\u521D\u5EFA\u96CF\u5F62" tabindex="-1">01. \u521D\u5EFA\u96CF\u5F62 <a class="header-anchor" href="#_01-\u521D\u5EFA\u96CF\u5F62" aria-hidden="true">#</a></h3><p>\u7531\u4E8E\u4E4B\u524D\u6709\u9605\u8BFB\u8FC7 <code>redux</code> \u7684\u6E90\u7801\uFF0C\u540C\u65F6\u4E5F\u5927\u81F4\u9605\u8BFB\u8FC7 <code>redux-thunk</code> \u7684\u6E90\u7801\uFF0C\u5E76\u4E14\u67E5\u9605\u4E86\u4E00\u4E9B\u4E0E redux \u76F8\u5173\u6587\u7AE0\uFF0C\u5728\u6709\u4E86\u4E00\u4E9B\u77E5\u8BC6\u50A8\u5907\u4E4B\u540E\uFF0C\u5F00\u59CB\u7740\u624B\u7F16\u5199\u76F8\u5173\u4EE3\u7801\u3002\uFF08\u4E0B\u9762\u6211\u4F1A\u4ECB\u7ECD\u90E8\u5206\u77E5\u8BC6\u70B9\uFF09</p><blockquote><p>\u5982\u679C\u4F60\u5BF9 redux \u6E90\u7801\u5B58\u5728\u7591\u60D1\uFF0C\u4F60\u4E0D\u59A8\u770B\u770B\u8FD9\u7BC7 <a href="https://juejin.cn/post/6844904183426973703" target="_blank" rel="noreferrer">\u3010KT\u3011\u8F7B\u677E\u641E\u5B9A Redux \u6E90\u7801\u89E3\u8BFB\u4E0E\u7F16\u7A0B\u827A\u672F</a></p></blockquote><p>\u5728\u53C2\u8003\u4E86 dva \u5BF9 model \u7684\u53C2\u6570\u8BF4\u660E\uFF0C\u8FDB\u884C\u53C2\u6570\u5B9A\u4E49\uFF0C\u7531\u4E8E\u6211\u6CA1\u6709 redux-saga \uFF0C\u6240\u4EE5\u662F\u6CA1\u6709 <code>effect</code> \u8FD9\u4E2A\u5C5E\u6027\u7684\uFF0C\u4E8E\u662F\u521D\u6B65\u5F97\u5230\u6211\u7684 model \u53C2\u6570</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/51a302b2e11b48f0b4a9e0f31c9c6bec~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="image.png"></p><p>\u4E0B\u9762\u662F\u4E00\u4E2A <code>model</code> \u7684\u7C7B\u578B\u7EA6\u675F</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModel</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// \u547D\u540D\u7A7A\u95F4</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">state</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">action</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">dispatch</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">getState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">currentAction</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">commit</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">call</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">) </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">void</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">reducers</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\u6309\u7167\u6211\u7684\u8BBE\u60F3\uFF0C\u6211\u4F1A\u5B58\u5728\u591A\u4E2A model \u6587\u4EF6\uFF0C\u805A\u96C6\u5728\u4E00\u8D77\u4E4B\u540E\uFF0C\u5F97\u5230\u7684\u662F\u4E00\u4E2A\u6570\u7EC4 :</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// model.js</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> aModel </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./aModel</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> bModel </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./bModel</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> cModel </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./cModel</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">default</span><span style="color:#A6ACCD;"> [aModel</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> bModel</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> cModel]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u6211\u6240\u5E0C\u671B\u7684\u662F\uFF1A\u901A\u8FC7\u4F20\u5165 <code>RModel[]</code>\uFF0C\u5B9E\u4F8B\u5316 <code>RcReduxModel</code>\uFF0C\u5F97\u5230\u7684\u5B9E\u4F8B\u5E26\u6709\u7ECF\u8FC7\u5904\u7406\u540E\u7684 reducers</p><ul><li>reducers\uFF1A\u6240\u6709 <code>model.reducers</code> \u96C6\u5408\uFF0C\u8FD9\u6837\u6211\u53EF\u4EE5\u65E0\u969C\u788D\u7684\u7528\u5728 <code>store.combineReducers</code>\u4E2D\uFF0C\u53EF\u4EE5\u517C\u5BB9\u4F60\u73B0\u6709\u7684\u9879\u76EE\uFF0C\u56E0\u4E3A\u53EA\u8981\u4F60\u7528\u4E86 redux\uFF0C \u90A3\u4E48\u4F60\u80AF\u5B9A\u5F97\u901A\u8FC7 <code>combineReducers API</code> \u53BB\u96C6\u5408\u6240\u6709\u7684 reducers</li></ul><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// createStore.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u{1F447} \u5BFC\u5165\u805A\u96C6\u6240\u6709 model\uFF0C\u5F97\u5230\u7684\u662F\u4E00\u4E2A\u6570\u7EC4</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> models </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./models</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> RcReduxModel </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rc-redux-model</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> reduxModel </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RcReduxModel</span><span style="color:#A6ACCD;">(models)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> reducerList </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">combineReducers</span><span style="color:#A6ACCD;">(reduxModel</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">reducers)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createStore</span><span style="color:#A6ACCD;">(reducerList)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u56E0\u4E3A\u6211\u60F3\u50CF\u5199 model \u90A3\u6837\uFF0C\u6240\u6709\u4E1C\u897F\u90FD\u5728\u4E00\u4E2A\u6587\u4EF6\u4E2D\uFF0C\u81EA\u7136\u800C\u7136\uFF0C\u8FD9\u4E2A action \u96C6\u5230 model \u91CC\u8FB9\u4E4B\u540E\uFF0C\u5982\u4F55\u5904\u7406\u5F02\u6B65\u5C31\u6210\u4E86\u6211\u9700\u8981\u89E3\u51B3\u7684\u4E00\u4E2A\u95EE\u9898</p><h3 id="_02-\u5F02\u6B65\u5904\u7406" tabindex="-1">02. \u5F02\u6B65\u5904\u7406 <a class="header-anchor" href="#_02-\u5F02\u6B65\u5904\u7406" aria-hidden="true">#</a></h3><p>\u6211\u53EF\u4EE5\u5C06 <code>redux-thunk</code> \u6216 <code>redux-saga</code> \u96C6\u6210\u8FDB\u53BB\uFF0C\u4F46\u611F\u89C9\u6CA1\u5FC5\u8981\u3002\u51FA\u4E8E\u5BF9\u8FD9\u4E24\u4E2A\u5E93\u7684\u5B66\u4E60\uFF0C\u4EE5\u53CA\u5728\u4F7F\u7528\u4E0A\u5E26\u7ED9\u6211\u7684 <strong>[\u4F53\u9A8C]</strong>\uFF0C\u6211\u5728\u60F3\uFF0C\u80FD\u4E0D\u80FD\u81EA\u884C\u5904\u7406\uFF1F\u4E8E\u662F\uFF0C\u6211\u53BB\u5C06 <code>redux-thunk</code> \u7684\u6E90\u7801\u770B\u4E86\u4E00\u904D\u3002</p><blockquote><p>redux-thunk \u4E2D\u5224\u65AD\u4F60\u7684 action \u662F function \u8FD8\u662F object\uFF0C\u4ECE\u800C\u5224\u65AD\u4F60\u7684 action \u662F\u540C\u6B65\u8FD8\u662F\u5F02\u6B65</p></blockquote><p>\u600E\u4E48\u7406\u89E3\u5462\uFF1F\u5927\u5BB6\u80AF\u5B9A\u90FD\u6709\u5199\u8FC7\u540C\u6B65 action \u6216\u8005\u5F02\u6B65 action</p><ul><li>\u540C\u6B65\uFF1A\u901A\u8FC7 dispatch \u53D1\u8D77\u4E00\u4E2A action\uFF0C\u53BB\u4FEE\u6539 redux \u7684 state \u503C</li><li>\u5F02\u6B65\uFF1A\u901A\u8FC7 dispatch \u53D1\u8D77\u4E00\u4E2A action\uFF0C\u7531\u4E8E redux \u6CA1\u6709\u5F02\u6B65\u80FD\u529B\uFF0C\u6240\u4EE5\u501F\u52A9 redux-thunk \u7684\u80FD\u529B\uFF0Credux-thunk \u53D1\u73B0\u4F60\u53D1\u8D77\u7684 action \u5E76\u4E0D\u662F\u4E00\u4E2A object\uFF0C\u800C\u662F\u4E00\u4E2A function\uFF0C\u5B83\u5C31\u4F1A\u53BB\u5E2E\u4F60\u628A\u8BF7\u6C42\u53D1\u51FA\uFF0C\u5F53\u8BF7\u6C42\u5904\u7406\u5B8C\u540E\uFF0C\u5F97\u5230\u6570\u636E\uFF0C\u4F60\u518D\u53D1\u8D77\u4E00\u4E2A\u540C\u6B65\u7684 action \u53BB\u4FEE\u6539 redux \u7684 state \u503C</li></ul><p>\u6700\u540E\u5F97\u51FA\u4E86\u4E00\u4E2A\u89E3\u51B3\u65B9\u6848\uFF1A<strong>\u5728 <code>rc-redux-model</code> \u4E2D\uFF0C\u6BCF\u4E00\u4E2A action \u90FD\u662F\u5F02\u6B65\u7684\uFF0C\u4E5F\u5C31\u662F\u4F60\u53D1\u8D77\u7684\u6BCF\u4E00\u4E2A action\uFF0C\u90FD\u662F\u51FD\u6570</strong>\u3002</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#A6ACCD;">aModel </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">state</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">a</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">action</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u8FD9\u4E24\u4E2A action \u90FD\u662F function</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">firstAction</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">getState</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">dispatch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">secondAction</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">getState</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">dispatch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p>\u5373\u4F7F\u4F60\u60F3\u8981\u53D1\u8D77\u4E00\u4E2A\u540C\u6B65 action\uFF0C\u53BB\u4FEE\u6539 state \u7684\u503C\uFF0C\u6211\u4E5F\u4F1A\u5C06\u5176\u4F5C\u4E3A\u5F02\u6B65\u8FDB\u884C\u5904\u7406\uFF0C\u4E5F\u5C31\u662F\u4F60\u4FEE\u6539 state \u503C\uFF0C\u4F60\u9700\u8981\u8FD9\u4E48\u5199</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// component.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u{1F447} 1. \u53D1\u8D77\u4E00\u4E2A action \u7528\u4E8E\u4FEE\u6539 state \u503C</span></span>
<span class="line"><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aModel/setStateA</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">payload</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">666</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;">// aModel.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">aModel </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aModel</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">state</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">a</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">111</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">action</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u{1F447} 2. \u8FD9\u662F\u5F02\u6B65action\uFF0C\u5728\u8FD9\u91CC\u4F60\u53EF\u4EE5\u505A\u5F02\u6B65\u8BF7\u6C42\uFF0C\u4E5F\u53EF\u4EE5\u505A\u540C\u6B65\u5904\u7406</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u603B\u4E4B\uFF0C\u5F02\u6B65\u6216\u540C\u6B65\uFF0C\u90FD\u9700\u8981\u7ECF\u8FC7\u8FD9\u91CC\u7684\u201C\u8F6C\u53D1\u201D\uFF0C\u518D\u53BB\u4FEE\u6539 state \u503C</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">setStateA</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">currentAction</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">dispatch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">dispatch</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aModel/CHANGE_STATE_A</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        payload</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentAction</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">payload</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">reducers</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">CHANGE_STATE_A</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">payload</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        a</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">payload</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p>\u660E\u786E\u4E86\u8FD9\u4E24\u70B9\uFF0C\u63A5\u4E0B\u6765\u5C31\u53EA\u9700\u8981\u5F00\u53D1\u5373\u53EF\u3002\u5F00\u53D1\u63A5\u4E0B\u6765\u6211\u4F1A\u8BB2\u5230\uFF0C\u6211\u4EEC\u7EE7\u7EED\u5F80\u4E0B\u770B</p><h3 id="_03-\u63D0\u9AD8\u4F53\u9A8C" tabindex="-1">03. \u63D0\u9AD8\u4F53\u9A8C <a class="header-anchor" href="#_03-\u63D0\u9AD8\u4F53\u9A8C" aria-hidden="true">#</a></h3><p>\u7531\u4E8E\u6BCF\u4E2A action\uFF0C\u90FD\u9700\u8981\u5C0F\u4F19\u4F34\u4EEC\u81EA\u5DF1\u53BB\u5199\uFF0C\u6781\u5EA6\u9EBB\u70E6\uFF0C\u4EE5\u4E0B\u9762\u8FD9\u4E2A\u4F8B\u5B50\u8BF4\u660E</p><p>\u6211\u60F3\u8981\u4FEE\u6539 state \u4E2D\u7684 a \u503C\uFF0C\u9700\u8981\u81EA\u5DF1\u5199 action\u3001reducers</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// aModel.js</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">aModel </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aModel</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">state</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">a</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">111</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">action</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u{1F447} 2. \u8FD9\u662F\u5F02\u6B65action\uFF0C\u5728\u8FD9\u91CC\u4F60\u53EF\u4EE5\u505A\u5F02\u6B65\u8BF7\u6C42\uFF0C\u4E5F\u53EF\u4EE5\u505A\u540C\u6B65\u5904\u7406</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u603B\u4E4B\uFF0C\u5F02\u6B65\u6216\u540C\u6B65\uFF0C\u90FD\u9700\u8981\u7ECF\u8FC7\u8FD9\u91CC\u7684\u201C\u8F6C\u53D1\u201D\uFF0C\u518D\u53BB\u4FEE\u6539 state \u503C</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">setStateA</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">currentAction</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">dispatch</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">dispatch</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aModel/CHANGE_STATE_A</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        payload</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentAction</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">payload</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">reducers</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">CHANGE_STATE_A</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">payload</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        a</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">payload</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p>\u5047\u8BBE\u6211\u73B0\u5728\u6709 20 \u4E2A state\uFF0C\u610F\u5473\u7740\u6211\u5F97\u5728 model.action \u4E2D\uFF0C\u5199\u5BF9\u5E94\u7684 20 \u4E2A\u4FEE\u6539 state \u7684 action\uFF0C\u7136\u540E\u5728 model.reducers \u4E2D\u540C\u6837\u5199 20 \u4E2A\u76F8\u5BF9\u5E94\u7684 reducer\uFF0C\u90A3\u4E48\u5C31\u4F1A\u4F7F\u5F97\u8BE5\u6587\u4EF6\u4EE3\u7801\u91CF\u6781\u5927\uFF0C\u90A3\u8DDF\u4E00\u5F00\u59CB\u5199 redux \u533A\u522B\u5728\u54EA\uFF1F\u770B\u8D77\u6765\u53EA\u662F\u5C06 state\u3001action\u3001reducers \u653E\u5728\u4E00\u4E2A\u6587\u4EF6\u800C\u5DF2\u3002<strong>\u5E76\u6CA1\u6709\u771F\u6B63\u7684\u89E3\u51B3\u7E41\u7410\u91CD\u590D\u7684\u5DE5\u4F5C</strong>\u3002</p><p>\u4E8E\u662F\u6211\u60F3\u5230\u4E86\u89E3\u51B3\u65B9\u6848\uFF1A\u63D0\u4F9B\u4E00\u4E2A\u9ED8\u8BA4\u7684 action\uFF0C\u5927\u5BB6\u90FD\u901A\u8FC7\u8FD9\u4E2A action \u53BB\u4FEE\u6539 state \u503C\u3002\u4F46\u8FD9\u4F1A\u6709\u4E2A\u95EE\u9898\uFF0C\u6240\u6709\u4FEE\u6539 state \u7684 action\uFF0C\u90FD\u8D70\u540C\u4E00\u4E2A <code>action.type</code>\uFF0C\u90A3\u4E48\u5728 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fzalmoxisus%2Fredux-devtools-extension" target="_blank" rel="noreferrer">redux-devtools-extension</a> \u4E2D\uFF0C\u662F\u5F88\u96BE\u53D1\u73B0\u8FD9\u4E2A action \u89E6\u53D1\uFF0C\u5177\u4F53\u662F\u4E3A\u4E86\u4FEE\u6539\u54EA\u4E2A state \u503C\u3002</p><p>\u5982\u4F55\u89E3\u51B3\u6B64\u95EE\u9898\u5462\uFF1F\u6700\u7EC8\u7684\u89E3\u51B3\u65B9\u6848\u5C31\u662F\uFF1A<strong>\u4E3A\u6BCF\u4E00\u4E2A state \uFF0C\u81EA\u52A8\u6CE8\u518C\u5BF9\u5E94\u7684 action \u548C reducer\uFF0C \u540C\u65F6\u518D\u63D0\u4F9B\u4E86\u4E00\u4E2A\u9ED8\u8BA4\u7684 action(setStore)</strong></p><blockquote><p>\u2728 \u4F8B : state \u6709 n \u4E2A\u503C\uFF0C\u90A3\u4E48\u6700\u7EC8\u4F1A\u81EA\u52A8\u6CE8\u518C n+1 \u4E2A action\uFF0C\u7528\u6237\u53EA\u9700\u8981\u8BB0\u4F4F\u5E76\u8C03\u7528\u9ED8\u8BA4\u7684\u8FD9\u4E2A action(setStore) \u5373\u53EF</p></blockquote><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/16444ad9771242c9a09aa9f911933d2c~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="image.png"></p><p>\u7528\u6237\u53EA\u9700\u8981\u8C03\u7528\u9ED8\u8BA4\u63D0\u4F9B\u7684 <code>setStore</code> \u5373\u53EF\uFF0C\u7136\u540E\u6839\u636E key \u8FDB\u884C\u5224\u65AD\uFF0C\u4ECE\u800C\u8F6C\u53D1\u5230\u5BF9\u5E94\u5230 action \u4E0A</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[model.namespace]/setStore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">payload</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`\${</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">}\`</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">values</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`\${</span><span style="color:#A6ACCD;">your values</span><span style="color:#89DDFF;">}\`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>\u7531\u4E8E <code>setStore</code> \u6BCF\u6B21\u90FD\u53EA\u80FD\u4FEE\u6539\u4E00\u4E2A state \u503C\uFF0C\u5982\u679C\u5728\u540C\u4E00\u65F6\u523B\uFF0C\u60F3\u4FEE\u6539 m \u4E2A state \u503C\uFF0C\u5C31\u5F97\u53D1 m \u4E2A action\uFF0C\u4E8E\u662F\u6211\u53C8\u6DFB\u52A0\u4E86\u4E00\u4E2A <code>setStoreList</code></p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[model.namespace]/setStoreList</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">payload</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`\${</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">}\`</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">values</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`\${</span><span style="color:#A6ACCD;">your values</span><span style="color:#89DDFF;">}\`</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`\${</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">}\`</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">values</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`\${</span><span style="color:#A6ACCD;">your values</span><span style="color:#89DDFF;">}\`</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_04-\u6570\u636E\u4E0D\u53EF\u53D8" tabindex="-1">04. \u6570\u636E\u4E0D\u53EF\u53D8 <a class="header-anchor" href="#_04-\u6570\u636E\u4E0D\u53EF\u53D8" aria-hidden="true">#</a></h3><p>\u5728\u51FD\u6570\u5F0F\u7F16\u7A0B\u8BED\u8A00\u4E2D\uFF0C\u6570\u636E\u662F\u4E0D\u53EF\u53D8\u7684\uFF0C<a href="https://link.juejin.cn/?target=http%3A%2F%2Fcn.redux.js.org%2Ftutorials%2Fessentials%2Fpart-1-overview-concepts%23%E4%B8%8D%E5%8F%AF%E5%8F%98%E6%80%A7-immutability" target="_blank" rel="noreferrer">(\u8FD9\u4E5F\u662F\u5B98\u65B9\u8BF4\u7684)</a>\uFF0C\u6240\u6709\u7684\u6570\u636E\u4E00\u65E6\u4EA7\u751F\uFF0C\u5C31\u4E0D\u80FD\u6539\u53D8\u5176\u4E2D\u7684\u503C\uFF0C\u5982\u679C\u8981\u6539\u53D8\uFF0C\u90A3\u5C31\u53EA\u80FD\u751F\u6210\u4E00\u4E2A\u65B0\u7684\u6570\u636E\u3002\u7531\u4E8E\u73B0\u5728\u5F88\u591A\u9879\u76EE\u90FD\u4F1A\u4F7F\u7528 <code>seamless-immutable</code>\uFF0C\u90A3\u4E48\u5728\u4E1A\u52A1\u4E2D\u7684 <code>model.state</code> \u4E2D\uFF0C\u4F7F\u7528\u4E86 Immutable \u5305\u88F9\u4E86 state\uFF0C\u7136\u540E\u8C03\u7528\u9ED8\u8BA4\u63D0\u4F9B\u7684 action\uFF0C\u6700\u540E\u4F1A\u62A5\u9519\uFF0C\u61C2\u7684\u90FD\u61C2 !</p><p>\u90A3\u4E48\u8BE5\u600E\u4E48\u529E\u5462\uFF1F\u5185\u90E8\u652F\u6301 Immutable \uFF0C\u63D0\u4F9B\u4E00\u4E2A\u914D\u7F6E\u53C2\u6570 <code>openSeamlessImmutable</code>\uFF0C\u9ED8\u8BA4\u4E3A false\uFF0C\u5982\u679C\u4F60\u4E1A\u52A1\u4E2D\u7684 state \u662F Immutable\uFF0C\u800C\u5728 model \u4E2D\u4E0D\u8BBE\u7F6E\u6B64\u914D\u7F6E\uFF0C\u90A3\u4E48\u4F1A\u62A5\u9519\u3002</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// \u4F7F\u7528 seamless-immutable</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> Immutable </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">seamless-immutable</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">appModel</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">state</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Immutable</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">openSeamlessImmutable</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// \u5FC5\u987B\u5F00\u542F\u6B64\u914D\u7F6E</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><h3 id="_05-\u5904\u7406\u7C7B\u578B\u4E0D\u4E00\u81F4" tabindex="-1">05. \u5904\u7406\u7C7B\u578B\u4E0D\u4E00\u81F4 <a class="header-anchor" href="#_05-\u5904\u7406\u7C7B\u578B\u4E0D\u4E00\u81F4" aria-hidden="true">#</a></h3><p>\u8FD9\u4E5F\u662F\u6211\u6709\u65F6\u5019\u72AF\u7684\u9519\u8BEF\uFF0C\u7279\u522B\u662F\u5728\u6CA1\u6709 TypeScript \u7684\u60C5\u51B5\u4E0B\uFF0C\u6211\u4EEC\u6709\u65F6\u5728 <code>model.state</code> \u4E2D\u5B9A\u4E49\u597D\u67D0\u4E2A\u503C\u7684\u7C7B\u578B\uFF0C\u4F46\u5728\u6539\u7684\u65F6\u5019\u5374\u5C06\u5176\u6539\u4E3A\u53E6\u4E00\u4E2A\u7C7B\u578B\uFF0C\u6BD4\u5982</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">userModel</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">state</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// \u8FD9\u91CC\u5B9A\u4E49 name \u4E3A string \u7C7B\u578B</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p>\u4F46\u5728\u4FEE\u6539\u6B64 state value \u65F6\uFF0C\u4F20\u9012\u7684\u786E\u662F\u4E00\u4E2A\u975E string \u7C7B\u578B\u7684\u503C</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">userModel/setStore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">payload</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">values</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{},</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// \u8FD9\u91CC name \u53D8\u6210\u4E86object</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u8FD9\u5176\u5B9E\u662F\u4E0D\u5408\u7406\u7684\uFF0C\u5728 rc-redux-model \u4E2D\uFF0C\u4F1A\u9488\u5BF9\u9700\u8981\u4FEE\u6539\u7684 <code>state[key]</code> \u505A\u7C7B\u578B\u68C0\u6D4B\u5904\u7406</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/98b7d90ef77c4f43b7a739dde95a1a92~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="image.png"></p><p>\u540C\u65F6\u505A <code>state[key]</code> \u5B57\u6BB5\u7684\u5904\u7406</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">userModel</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">state</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// \u8FD9\u91CC\u53EA\u5B9A\u4E49 state \u4E2D\u5B58\u5728 name</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p>\u6B64\u65F6\u60F3\u4FEE\u6539 state \u4E2D\u7684\u53E6\u4E00\u5C5E\u6027\u503C</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">props</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">userModel/setStore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">payload</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">testName</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">values</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// \u8FD9\u91CC\u60F3\u4FEE\u6539 testName \u5C5E\u6027\u7684\u503C</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u6781\u5EA6\u4E0D\u5408\u7406\uFF0C\u56E0\u4E3A\u4F60\u5728 state \u4E2D\u5E76\u6CA1\u6709\u58F0\u660E\u6B64\u5C5E\u6027\uFF0C rc-redux-model \u4F1A\u9ED8\u8BA4\u5E2E\u4F60\u505A\u68C0\u6D4B</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/297af08ca0b94602b30009c52791d0b8~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="image.png"></p><h3 id="c-\u6838\u5FC3\u6E90\u7801\u89E3\u8BFB" tabindex="-1">C. \u6838\u5FC3\u6E90\u7801\u89E3\u8BFB <a class="header-anchor" href="#c-\u6838\u5FC3\u6E90\u7801\u89E3\u8BFB" aria-hidden="true">#</a></h3><p>\u4E0A\u8BC9\u66F4\u591A\u7684\u662F\u5BF9\u4E2D\u95F4\u4EF6\u7684\u601D\u8003\u548C\u529F\u80FD\u7684\u8BBE\u8BA1\uFF0C\u63A5\u4E0B\u6765\u6211\u4EEC\u7ED3\u5408\u4EE3\u7801\uFF0C\u6765\u770B\u770B\u4E00\u6B3E redux \u4E2D\u95F4\u4EF6\u8BE5\u5982\u4F55\u5F00\u53D1\u3002\u5728\u6B64\u4E4B\u524D\uFF0C\u6211\u5E0C\u671B\u4F60\u80FD\u5BF9 redux \u6709\u4E00\u5B9A\u7684\u4E86\u89E3\uFF0C\u6211\u7ED9\u4F60\u4EEC\u51C6\u5907\u4E86\u51E0\u7BC7\u6587\u7AE0\uFF0C\u90FD\u662F\u6211\u5728\u5F00\u53D1\u4E2D\u95F4\u4EF6\u524D\u770B\u7684\u6587\u7AE0\u5185\u5BB9\uFF0C\u5982\u679C\u4F60\u611F\u5174\u8DA3\uFF0C\u53EF\u4EE5\u70B9\u51FB\u4E0B\u65B9\u94FE\u63A5\u67E5\u770B</p><ul><li><a href="https://juejin.cn/post/6844904183426973703" target="_blank" rel="noreferrer">\u8F7B\u677E\u641E\u5B9A Redux \u6E90\u7801\u89E3\u8BFB\u4E0E\u7F16\u7A0B\u827A\u672F</a></li><li><a href="https://link.juejin.cn/?target=https%3A%2F%2Ftech.meituan.com%2F2017%2F07%2F14%2Fredux-design-code.html" target="_blank" rel="noreferrer">redux \u4ECE\u8BBE\u8BA1\u5230\u6E90\u7801\u2014\u2014\u7F8E\u56E2\u6280\u672F\u56E2\u961F</a></li><li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fcloud.tencent.com%2Fdeveloper%2Fnews%2F41333" target="_blank" rel="noreferrer">redux \u4E4B\u6D0B\u8471\u6A21\u578B\u7684\u6E90\u7801\u5206\u6790\u4E0E\u611F\u609F</a></li><li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fcloud.tencent.com%2Fdeveloper%2Fnews%2F41333" target="_blank" rel="noreferrer">\u6DF1\u5165\u6D45\u51FA Event Sourcing \u548C CQRS</a></li><li><a href="https://link.juejin.cn/?target=http%3A%2F%2Fcn.redux.js.org%2Ftutorials%2Fessentials%2Fpart-1-overview-concepts" target="_blank" rel="noreferrer">\u2728 redux \u5B98\u65B9\u6559\u7A0B\uFF08\u63A8\u8350\uFF09</a></li></ul><blockquote><p>\u6700\u8D77\u7801\u4E0A\u9762 Part B \u90E8\u5206\u4E2D\u7684 action\u3001reducer \u7B49\u4F60\u90FD\u5F97\u660E\u767D\u5427\uFF1F\u4F60\u5F97\u77E5\u9053\u4E00\u4E2A action \u662F\u600E\u6837\u7684\uFF0Creducer \u662F\u600E\u6837\u7684\uFF0C\u4E0D\u7136\u4E0B\u9762\u4F60\u7406\u89E3\u65F6\u4F1A\u975E\u5E38\u56F0\u96BE\u3002</p></blockquote><p>\u770B\u5B8C\u4E4B\u540E\uFF0C\u6211\u4EEC\u9700\u8981\u638C\u63E1\u51E0\u4E2A\u6700\u57FA\u7840\u4E14\u91CD\u8981\u7684\u8BCD\u6C47\uFF1A<code>\u51FD\u6570\u5F0F\u7F16\u7A0B</code>\u3001<code>compose</code>\u3001<code>\u6D0B\u8471\u6A21\u578B</code>\uFF0C\u4E0D\u8981\u6025\uFF0C\u6211\u4EEC\u4E00\u4E2A\u4E2A\u6765\u8FC7\u77E5\u8BC6\u70B9\u3002</p><h4 id="\u51FD\u6570\u5F0F\u7F16\u7A0B" tabindex="-1">\u51FD\u6570\u5F0F\u7F16\u7A0B <a class="header-anchor" href="#\u51FD\u6570\u5F0F\u7F16\u7A0B" aria-hidden="true">#</a></h4><ol><li>\u51FD\u6570\u662F\u7B2C\u4E00\u7B49\u516C\u6C11</li></ol><p>\u600E\u4E48\u7406\u89E3\uFF0C\u5728 JS \u4E2D\uFF0C\u51FD\u6570\u53EF\u4EE5\u5F53\u4F5C\u662F\u53D8\u91CF\u4F20\u5165\uFF0C\u4E5F\u53EF\u4EE5\u8D4B\u503C\u7ED9\u4E00\u4E2A\u53D8\u91CF\uFF0C\u751A\u81F3\u4E8E\uFF0C\u51FD\u6570\u6267\u884C\u7684\u8FD4\u56DE\u7ED3\u679C\u4E5F\u53EF\u4EE5\u662F\u51FD\u6570\u3002</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> func </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// 1. \u5F53\u4F5C\u53C2\u6570</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">demo1</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">func</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// 2. \u8D4B\u503C\u7ED9\u53E6\u4E00\u4E2A\u53D8\u91CF</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> copy_func </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> func</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// 3. \u51FD\u6570\u6267\u884C\u7684\u8FD4\u56DE\u7ED3\u679C\u662F\u51FD\u6570</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">demo2</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">func</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><ol><li>\u6570\u636E\u662F\u4E0D\u53EF\u53D8\u7684(Immutable)</li></ol><p>\u5728\u51FD\u6570\u5F0F\u7F16\u7A0B\u8BED\u8A00\u4E2D\uFF0C\u6570\u636E\u662F\u4E0D\u53EF\u53D8\u7684\uFF0C\u6240\u6709\u7684\u6570\u636E\u4E00\u65E6\u4EA7\u751F\uFF0C\u5C31\u4E0D\u80FD\u6539\u53D8\u5176\u4E2D\u7684\u503C\uFF0C\u5982\u679C\u8981\u6539\u53D8\uFF0C\u90A3\u5C31\u53EA\u80FD\u751F\u6210\u4E00\u4E2A\u65B0\u7684\u6570\u636E\u3002</p><p>\u6240\u4EE5\u6211\u4EEC\u5728 redux \u4E2D\u5F3A\u8C03\u4E86\uFF0C\u4E0D\u80FD\u76F4\u63A5\u4FEE\u6539 state \u7684\u503C\uFF0C<strong><a href="https://link.juejin.cn/?target=http%3A%2F%2Fcn.redux.js.org%2Ftutorials%2Fessentials%2Fpart-1-overview-concepts%23%E4%B8%8D%E5%8F%AF%E5%8F%98%E6%80%A7-immutability" target="_blank" rel="noreferrer">\u4EE3\u7801\u5FC5\u9700\u5148\u590D\u5236\u539F\u6765\u7684 object/array\uFF0C\u7136\u540E\u66F4\u65B0\u5B83\u7684\u590D\u5236\u4F53\u3002Redux \u671F\u671B\u6240\u6709\u72B6\u6001\u66F4\u65B0\u90FD\u662F\u4F7F\u7528\u4E0D\u53EF\u53D8\u7684\u65B9\u5F0F</a>\u3002</strong></p><blockquote><p>\u989D\u5916\u8865\u5145\u4E00\u4E0B\uFF0C\u4E0B\u8FB9\u7684\u4E24\u53E5\u8BDD\u5F15\u7528\u6765\u81EA <code>Dan Abramov</code> \u7684\u535A\u5BA2: <a href="https://link.juejin.cn/?target=https%3A%2F%2Foverreacted.io%2Fhow-are-function-components-different-from-classes%2F" target="_blank" rel="noreferrer">How Are Function Components Different from Classes?</a> \u5728 react \u4E2D\uFF0C\u6211\u4EEC\u4ECE <code>this.props.xxx</code> \u4E2D\u8BFB\u53D6\u6570\u636E\u3002\u4E3A\u4EC0\u4E48\u6211\u4EEC\u53EF\u4EE5\u5F97\u5230\u6700\u65B0\u7684\u5B9E\u4F8B\uFF1F\u5176\u5B9E\u4E0D\u662F\u56E0\u4E3A props \u6539\u53D8\u4E86\uFF0C\u5728 react \u4E2D\uFF0Cprops \u662F\u4E0D\u53EF\u53D8(immutable)\u7684\uFF0C\u4ED6\u4EEC\u6C38\u8FDC\u4E0D\u4F1A\u6539\u53D8\u3002\u7136\u800C\uFF0Cthis \u662F\u53EF\u53D8(mutable)\u7684\u3002\u8FD9\u5C31\u662F react \u7C7B\u7EC4\u4EF6 this \u5B58\u5728\u7684\u610F\u4E49\u3002</p></blockquote><ol><li>\u51FD\u6570\u53EA\u63A5\u53D7\u4E00\u4E2A\u53C2\u6570</li></ol><p>\u600E\u4E48\u7406\u89E3\uFF0C\u5927\u4F19\u4F30\u8BA1\u90FD\u5199\u4E86\u5F88\u4E45\u7684\u591A\u53C2\u6570\uFF0C\u770B\u5230\u8FD9\u4E2A\u61F5\u4E86\u554A\uFF0C\u6211\u4E5F\u61F5\u4E86\uFF0C\u4F46\u662F\u8FD9\u5C31\u662F\u89C4\u77E9\uFF0C\u65E0\u89C4\u77E9\uFF0C\u4E0D\u6210\u65B9\u5706 \uFF5E</p><p>\u6240\u4EE5\u5F53\u4F60\u770B<strong>\u4E2D\u95F4\u4EF6</strong>\u7684\u4EE3\u7801\u65F6\uFF0C\u4F60\u5C31\u4E0D\u4F1A\u5947\u602A\u4E86\uFF0C\u6BD4\u5982\u8FD9\u884C\u4EE3\u7801 \uFF5E</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> middleware </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"></span></code></pre></div><p>\u6362\u6210\u6211\u4EEC\u80FD\u591F\u7406\u89E3\u7684\u5F62\u5F0F\uFF0C\u90A3\u5C31\u662F :</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> middleware </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p>\u8FD9\u91CC\u6709\u4EBA\u5C31\u7591\u95EE\u4E86\uFF0C\u8FD9\u4E0D\u5C31\u662F\u4F9D\u8D56\u4E86\u4E09\u4E2A\u53C2\u6570\u5417\uFF0C\u90A3\u80FD\u4E0D\u80FD\u8FD9\u6837\u5199\u554A\uFF1F</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> middleware </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"></span></code></pre></div><p>\u53EF\u4EE5\uFF0C\u4F46\u8FD9\u662F\u89C4\u77E9\uFF0C\u662F\u51FD\u6570\u5F0F\u7F16\u7A0B\u5C31\u662F\u8981\u6C42\u53EA\u80FD\u6709\u4E00\u4E2A\u53C2\u6570\uFF0C\u61C2 ?</p><h4 id="\u7EC4\u5408-compose" tabindex="-1">\u7EC4\u5408 compose <a class="header-anchor" href="#\u7EC4\u5408-compose" aria-hidden="true">#</a></h4><p>\u8BF4\u8BF4\u7EC4\u5408 compose\uFF0C\u8FD9\u4E2A\u662F\u4E2A\u5565\u73A9\u610F\uFF0C\u6211\u4EEC\u6765\u770B\u4E00\u6BB5\u4EE3\u7801 :</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> compose </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">f</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">g</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">f</span><span style="color:#F07178;">(</span><span style="color:#82AAFF;">g</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> add </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> del </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u4F7F\u7528\u7EC4\u5408\u51FD\u6570\uFF0C\u{1F9EC} \u57FA\u56E0\u7A81\u53D8\uFF0C\u5F3A\u5F3A\u8054\u5408</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> composeFunction </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">compose</span><span style="color:#A6ACCD;">(add</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> del)(</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u731C\u4E00\u4E0B\uFF0C\u6267\u884C composeFunction \u6253\u5370\u4EC0\u4E48\uFF1F\u7B54\u5BF9\u7684\uFF0C\u7ED9\u81EA\u5DF1\u9F13\u4E2A\u638C \u{1F44F}</p><p>\u597D\u4E86\uFF0C\u6211\u5DF2\u7ECF\u628A\u6700\u4E3A\u5F3A\u5927\u7684\u5FCD\u672F\uFF1A\u51FD\u6570\u5F0F\u7F16\u7A0B\u672F\u8BED\u4E4B compose \u7EC4\u5408\u51FD\u6570\uFF0C\u6559\u7ED9\u4F60\u4E86\uFF5E \u4F60\u591A\u770B\u51E0\u904D\uFF0C\u4E4B\u540E\u4F60\u770B redux \u7684\u6E90\u7801\u4F60\u5C31\u6709\u79CD\u918D\u9190\u704C\u5730\u7684\u611F\u89C9\u3002</p><h4 id="\u6D0B\u8471\u6A21\u578B" tabindex="-1">\u6D0B\u8471\u6A21\u578B <a class="header-anchor" href="#\u6D0B\u8471\u6A21\u578B" aria-hidden="true">#</a></h4><p>\u6D0B\u8471\u6A21\u578B\u662F\u672C\u8D28\u4E0A\u662F\u4E00\u5C42\u5C42\u7684\u5904\u7406\u903B\u8F91\uFF0C\u800C\u5728\u51FD\u6570\u5F0F\u7F16\u7A0B\u4E16\u754C\u91CC\uFF0C\u610F\u5473\u7740\u7528\u51FD\u6570\u6765\u505A\u5904\u7406\u5355\u5143\u3002\u5148\u4E0D\u8BF4\u5176\u4ED6\uFF0C\u6211\u4EEC\u5148\u4E0A\u4E00\u4E2A\u4F8B\u5B50\uFF0C\u5E2E\u52A9\u5927\u5BB6\u7406\u89E3\uFF5E</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> middleware </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> []</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">middleware</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">A</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">A1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">middleware</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">B</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">B1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">middleware</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u8FD9\u91CC\u7684 run \u4E0D\u7528 care</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> func </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">run</span><span style="color:#A6ACCD;">(middleware)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#82AAFF;">func</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u731C\u731C\u6253\u5370\u987A\u5E8F\u662F\u4E2A\u5565 \uFF1F\u6CA1\u9519\uFF0C\u6253\u5370\u7ED3\u679C\u4E3A : A -&gt; B -&gt; C -&gt; B1 -&gt; A1</p><p>\u5F53\u7A0B\u5E8F\u8FD0\u884C\u5230 <code>next()</code> \u7684\u65F6\u5019\u4F1A\u6682\u505C\u5F53\u524D\u7A0B\u5E8F\uFF0C\u8FDB\u5165\u4E0B\u4E00\u4E2A\u4E2D\u95F4\u4EF6\uFF0C\u5904\u7406\u5B8C\u4E4B\u540E\u624D\u4F1A\u4ED4\u56DE\u8FC7\u5934\u6765\u7EE7\u7EED\u5904\u7406\u3002</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c6c7365ec7224aae815de0b4ddaa72fb~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="img"></p><p>\u6211\u4EEC\u770B\u8FD9\u5F20\u56FE\uFF0C\u5F88\u6709\u610F\u601D\uFF0C\u4F1A\u6709\u4E24\u6B21\u8FDB\u5165\u540C\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u7684\u884C\u4E3A\uFF0C\u800C\u4E14\u662F\u5728\u6240\u6709\u7B2C\u4E00\u6B21\u7684\u4E2D\u95F4\u4EF6\u6267\u884C\u4E4B\u540E\uFF0C\u624D\u4F9D\u6B21\u8FD4\u56DE\u4E0A\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u3002\u4F60\u54C1\uFF0C\u4F60\u7EC6\u54C1\uFF5E</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/09c6b76fffb64795bcd663f883bb3a75~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="img"></p><p>\u5982\u679C\u4F60\u80FD\u770B\u61C2\u4E0A\u9762\u8FD9\u6BB5\u4E2D\u95F4\u4EF6\u7684\u4EE3\u7801\uFF0C\u90A3\u4E48\u6211\u7A0D\u5FAE\u6539\u5199\u4E00\u4E0B\uFF0C\u4F60\u4E5F\u5E94\u8BE5\u770B\u5F97\u61C2</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">f1</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">step1 \u4E2D\u95F4\u4EF61 \u5F00\u59CB</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">step2 \u4E2D\u95F4\u4EF61 \u7ED3\u675F</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">f2</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">step3 \u4E2D\u95F4\u4EF62 \u5F00\u59CB</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">step4 \u4E2D\u95F4\u4EF62 \u7ED3\u675F</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">f3</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">step5 \u4E2D\u95F4\u4EF63 \u5F00\u59CB</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">step6 \u4E2D\u95F4\u4EF63 \u7ED3\u675F</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">reducer</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">type</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">INIT_STORE</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">\u6211\u662F\u5927\u5E05\u54E5</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> store </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Redux</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createStore</span><span style="color:#A6ACCD;">(reducer</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Redux</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">applyMiddleware</span><span style="color:#A6ACCD;">(f1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> f2</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> f3))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispatch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">INIT_STORE</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u8FD9\u65F6\u5019\u60F3\u5FC5\u5927\u5BB6\u8FD8\u662F\u6709\u4E9B\u96BE\u4EE5\u7406\u89E3\uFF0C\u5927\u6982\u89E3\u8BFB\u4E00\u4E0B\uFF0C\u5728\u8FD9\u4E2A\u793A\u4F8B\u4EE3\u7801\u4E2D\uFF0C\u6D0B\u8471\u6A21\u578B\u8FD0\u884C\u8FC7\u7A0B\u5C31\u662F\uFF1A</p><p>\u6D3E\u53D1 action \u2192 \u7ECF\u8FC7 <code>applyMiddleware API</code> \u7684\u7EC4\u5408 -&gt; action \u4F20\u5165 f1 \u526F\u4F5C\u7528 \u2192 \u6253\u5370 step1 \u2192 \u6267\u884C f1 \u7684 next\uFF08\u8FD9\u4E2A next \u6307\u5411 f2 \u526F\u4F5C\u7528\uFF09\u2192 \u6253\u5370 step3 \u2192 \u6267\u884C f2 \u7684 next\uFF08\u8FD9\u4E2A next \u6307\u5411 f3 \u526F\u4F5C\u7528\uFF09\u2192 \u6253\u5370 step5 \u2192 \u6267\u884C f3 \u7684 next\uFF08\u8FD9\u4E2A next \u6307\u5411<code>store.dispatch</code>\uFF09\u2192 \u6267\u884C\u5B8C\u6BD5 -&gt; \u6253\u5370\u6211\u662F\u5927\u5E05\u54E5 -&gt; \u8FD4\u56DE\u5230 f3 \u526F\u4F5C\u7528\u6253\u5370 step6 \u2192 \u8FD4\u56DE\u5230 f2 \u6253\u5370 step4 \u2192 \u8FD4\u56DE\u5230 f1 \u526F\u4F5C\u7528\u6253\u5370 step2 -&gt; dispatch \u6267\u884C\u5B8C\u6BD5\u3002</p><p>\u6709\u4EBA\u5C31\u4F1A\u597D\u5947\u4E86\uFF0C\u8FD9\u91CC\u7684 <code>next</code> \u5230\u5E95\u662F\u4EC0\u4E48\u4E1C\u897F\uFF0C\u5176\u5B9E\u4ED6\u5C31\u662F <code>store.dispatch</code>\uFF0C\u6709\u70B9\u9976\uFF1F\u6211\u4EEC\u6765\u68B3\u7406\u4E00\u4E0B\u3002</p><p>\u5982\u679C\u4F60\u8FD8\u4E0D\u592A\u80FD\u7406\u89E3\uFF0C\u8BF7\u653E\u8F7B\u677E\uFF0C\u5148\u628A\u4E0A\u8FB9\u6211\u7ED9\u7684\u51E0\u4E2A\u94FE\u63A5\u6587\u7AE0\u770B\u4E00\u770B\uFF0C\u5E76\u4E14\u53BB\u641C\u7D22\u76F8\u5173\u77E5\u8BC6\uFF0C\u81EA\u5DF1\u8865\u5145\u8865\u5145\u77E5\u8BC6\u3002\u5982\u679C\u4F60\u80FD\u770B\u61C2\u4E0A\u9762\u8FD9\u6BB5\u4E2D\u95F4\u4EF6\u7684 store \u4F8B\u5B50\uFF0C\u90A3\u4E48\u8BF7\u6DF1\u547C\u5438\u4E00\u53E3\u6C14\uFF0C\u63A5\u4E0B\u6765\u6211\u4EEC\u518D\u6DF1\u5165\u4E00\u70B9\u3002\u770B\u770B <code>applyMiddleware</code> \u7684\u6E90\u7801\uFF0C\u4E0D\u8981\u6000\u7591\uFF0C\u8FD9\u771F\u7684\u662F redux \u7684\u6E90\u7801\u3002</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">applyMiddleware</span><span style="color:#89DDFF;">(...</span><span style="color:#A6ACCD;">middlewares</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">createStore</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">reducer</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">store</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">createStore</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">reducer</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">args</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dispatch</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Dispatch</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">middlewareAPI</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        getState</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">getState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">dispatch</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">dispatch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">args</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">chain</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">middlewares</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">middleware</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">middleware</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">middlewareAPI</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">dispatch</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">compose</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">chain</span><span style="color:#F07178;">)(</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dispatch</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">dispatch</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\u77ED\u77ED\u5341\u51E0\u884C\u4EE3\u7801\uFF0C\u5C06\u6211\u4EEC\u4E0A\u8FB9\u8BF4\u7684\u77E5\u8BC6\u70B9\u90FD\u5305\u542B\u4E86\u3002\u4E0D\u8981\u6000\u7591\uFF0C\u8FD9\u5C31\u662F\u6E90\u7801\uFF0C\u5148\u8BD5\u7740\u7406\u89E3\u4E00\u4E0B\u3002</p><p>\u9996\u5148\uFF0C\u4F20\u5165\u4E86\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u6570\u7EC4 <code>middlewares</code>\uFF0C\u6211\u4EEC\u5C06\u5B83\u8FDB\u884C\u5265\u76AE\uFF0C\u5E76\u7ED9\u4E2D\u95F4\u4EF6 middleware \u90FD\u4EE5\u6211\u4EEC\u5B9A\u4E49\u7684 middlewareAPI \u4F5C\u4E3A\u53C2\u6570\u6CE8\u5165\uFF0C\u6240\u4EE5\u6211\u4EEC\u6BCF\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u7684\u4E0A\u4E0B\u6587\u662F dispatch \u548C getState\uFF0C\u4E3A\u4EC0\u4E48\uFF1F\u4E3A\u4EC0\u4E48\u8981\u6CE8\u5165\u8FD9\u4E24\u4E2A\u73A9\u610F\uFF1F\u56E0\u4E3A</p><ul><li>getState\uFF1A\u6BCF\u4E00\u5C42\u6D0B\u8471\u90FD\u53EF\u4EE5\u83B7\u53D6\u5230\u5F53\u524D\u7684\u72B6\u6001\u3002</li><li>dispatch\uFF1A\u4E3A\u4E86\u53EF\u4EE5\u5C06\u64CD\u4F5C\u4F20\u9012\u7ED9\u4E0B\u4E00\u4E2A\u6D0B\u8471\u3002</li></ul><p>\u90A3\u5B83\u662F\u5982\u4F55\u7ED9\u6BCF\u4E00\u4E2A middleware \u6CE8\u5165\u7684\u5462\uFF1F\u770B\u8FD9\u6BB5\u4EE3\u7801\uFF1A</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> chain </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> middlewares</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">middleware</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">middleware</span><span style="color:#A6ACCD;">(middlewareAPI))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u904D\u5386 middlewares\uFF0C\u7136\u540E\u6BCF\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u90FD\u6CE8\u5165 <code>store.getState</code> \u548C <code>store.dispatch</code>\uFF0C\u90A3\u7ECF\u8FC7\u8FD9\u6837\u5904\u7406\u4E4B\u540E\uFF0Cchain \u662F\u4E2A\u4EC0\u4E48\u4E1C\u897F\uFF1F</p><p>\u5F88\u597D\u7406\u89E3\uFF0C\u4E0A\u9762\u8BF4\u8FC7\u4E86\u51FD\u6570\u5F0F\u7F16\u7A0B\u7684\u8981\u70B9\uFF1A\u51FD\u6570\u53EA\u63A5\u53D7\u4E00\u4E2A\u53C2\u6570\uFF0C\u518D\u590D\u4E60\u4E00\u4E0B\u8FD9\u6BB5\u4EE3\u7801</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> middleware </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"></span></code></pre></div><p>\u662F\u5426\u6709\u4E9B\u773C\u719F\uFF0C\u6539\u5199\u6210\u6211\u4EEC\u719F\u77E5\u7684\u51FD\u6570\u5F0F\u7F16\u7A0B\uFF0C\u5C31\u53D8\u6210\u4E0B\u9762\u8FD9\u6837\u4E86</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> middleware </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"></span></code></pre></div><p>\u4E5F\u5C31\u662F\u8BF4\uFF0Cchain \u5176\u5B9E\u662F\u4E00\u4E2A <code>(store) =&gt; (next) =&gt; (action) =&gt; {}</code> \u51FD\u6570\u7684\u6570\u7EC4\uFF0C\u4E5F\u5C31\u662F\u4E2D\u95F4\u4EF6\u5265\u5F00\u540E\u8FD4\u56DE\u7684\u51FD\u6570\u7EC4\u6210\u7684\u6570\u7EC4\u3002</p><p>\u6211\u4EEC\u518D\u770B\u770B\u8FD9\u884C\u4EE3\u7801</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#A6ACCD;">dispatch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">compose</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">chain)(store</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dispatch)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p><code>compose</code> \u5E94\u8BE5\u4E0D\u964C\u751F\u4E86\uFF0C\u7EC4\u5408\u51FD\u6570\uFF0C\u8FD9\u91CC\u7684\u4EE3\u7801\u6539\u6210\u6211\u4EEC\u5E38\u89C1\u7684\u6837\u5B50\uFF0C\u5C31\u662F\u4E0B\u9762\u8FD9\u79CD\u5F62\u5F0F</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">compose</span><span style="color:#89DDFF;">(...</span><span style="color:#A6ACCD;">chain</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">store.dispatch</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">chain</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">reduce</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">b</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">store.dispatch</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">a</span><span style="color:#F07178;">(</span><span style="color:#82AAFF;">b</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dispatch</span><span style="color:#F07178;">)))</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\u6211\u4EEC\u4EE5 store.dispatch \u4F5C\u4E3A\u53C2\u6570\u8FDB\u884C\u6CE8\u5165\uFF5E \u901A\u8FC7 compose \u5BF9\u4E2D\u95F4\u4EF6\u6570\u7EC4\u5185\u5265\u51FA\u6765\u7684\u9AD8\u9636\u51FD\u6570\u8FDB\u884C\u7EC4\u5408\u5F62\u6210\u4E00\u4E2A\u8C03\u7528\u94FE\u3002\u8C03\u7528\u4E00\u6B21\uFF0C\u4E2D\u95F4\u4EF6\u5185\u7684\u6240\u6709\u51FD\u6570\u90FD\u5C06\u88AB\u6267\u884C\u3002</p><p>\u77E5\u8BC6\u91CF\u6709\u70B9\u591A\uFF0C\u5982\u679C\u89C9\u5F97\u6709\u70B9\u4E71\uFF0C\u6211\u4EEC\u518D\u6765\u634B\u4E00\u634B\u3002</p><ul><li>\u629B\u51FA\u7B2C\u4E00\u4E2A\u95EE\u9898\uFF1F<code>dispatch \u662F\u7528\u6765\u5E72\u561B\u7684\uFF1F</code></li></ul><p>dispatch \u662F\u7528\u6765\u5206\u53D1 action \u7684\`\uFF0Cgood\uFF0C\u90A3\u4E48\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5F97\u5230\u7B2C\u4E00\u4E2A\u51FD\u6570</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store.dispatch</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"></span></code></pre></div><ul><li>\u8FD9\u91CC\u629B\u51FA\u7B2C\u4E8C\u4E2A\u95EE\u9898\uFF0C\u4E3A\u4E86\u5728\u6BCF\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u4E2D\uFF0C\u90FD\u9700\u8981\u5F97\u5230\u5B9E\u65F6\u7684 store \u6570\u636E\uFF0C\u600E\u4E48\u641E\uFF1F</li></ul><p>\u90A3\u5C31\u4E0D\u9700\u8981\u53EA\u4F20 <code>store.dispatch</code>\uFF0C\u518D\u7ED9\u5B83\u4F20\u4E00\u4E2A <code>store.getState</code>\uFF0C\u90A3\u4E48\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5F97\u5230\u4FEE\u6539\u540E\u7684\u51FD\u6570</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store.dispatch</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> store.getState</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"></span></code></pre></div><ul><li>\u7B2C\u4E09\u4E2A\u95EE\u9898\uFF0C\u4E3A\u4E86\u8BA9\u4E0B\u4E00\u4E2A\u4E2D\u95F4\u4EF6\uFF0C\u5177\u5907 dispatch \u7684\u80FD\u529B\uFF0C\u8BE5\u600E\u4E48\u529E\uFF1F</li></ul><p>\u90A3\u5C31\u628A store.dispatch \u4F20\u7ED9\u4E0B\u4E00\u4E2A\u4E2D\u95F4\u4EF6\uFF0C\u8BA9\u5B83\u5177\u5907 <code>dispatch</code> \u80FD\u529B\uFF0C\u90A3\u4E48\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5F97\u5230\u4FEE\u6539\u540E\u7684\u51FD\u6570</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store.dispatch</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> store.getState</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store.dispatch</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"></span></code></pre></div><ul><li>\u7B2C\u56DB\u4E2A\u95EE\u9898\uFF0C\u4E3A\u4E86\u80FD\u591F\u8BA9\u6BCF\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u6301\u6709\u6700\u7EC8\u7684 dispatch\uFF0C\u5982\u4F55\u5904\u7406\uFF1F</li></ul><p>redux \u5F00\u53D1\u8005\u5229\u7528\u4E86\u95ED\u5305\u7684\u7279\u6027\uFF0C\u5C06\u5185\u90E8\u7684 dispatch \u4E0E\u5916\u90E8\u8FDB\u884C\u5F3A\u7ED1\u5B9A\uFF0C\u4E5F\u5C31\u662F\u8FD9\u6BB5\u4EE3\u7801</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// \u8FD9\u662F\u6211\u4EEC\u610Fyin\u7684\u4EE3\u7801</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> dispatch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">middlewares</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">middleware</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">middleware</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    getState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">dispatch</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dispatch</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;">// \u6620\u5C04\u5230 redux \u4E2D\u7684\u771F\u5B9E\u6E90\u7801</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> middlewareAPI </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">getState</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> store</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">getState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">dispatch</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">dispatch</span><span style="color:#A6ACCD;">(action</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">args)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u5176\u5B9E\u4F60\u628A middlewareAPI \u5199\u5230 middleware \u91CC\u8FB9\uFF0C\u5C31\u7B49\u4EF7\u4E8E\u4E0A\u8FB9\u90A3\u73A9\u610F\u4E86</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> chain </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> middlewares</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">middleware</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">middleware</span><span style="color:#A6ACCD;">(middlewareAPI))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">dispatch </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">compose</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">chain)(store</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dispatch)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u6240\u4EE5\u6700\u7EC8\u6211\u4EEC\u5BF9\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u5F62\u5F0F\u5C31\u662F\uFF1A</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#82AAFF;">middleware</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store.dispatch</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> store.getState</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store.dispatch</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u6539\u4E00\u4E0B\u540D\u79F0</span></span>
<span class="line"><span style="color:#82AAFF;">middleware</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store.dispatch</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> store.getState</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"></span></code></pre></div><ul><li>\u95EE\u9898\u4E94\uFF0Cdispatch \u5728\u8FD9\u91CC\u8FB9\u626E\u6F14\u4E86\u4EC0\u4E48\u89D2\u8272\uFF1F</li><li>\u7ED1\u5B9A\u4E86\u5404\u4E2A\u4E2D\u95F4\u4EF6\u7684 next\uFF0C\u8BF4\u4E86 next \u5B9E\u9645\u4E0A\u5C31\u662F store.dispatch</li><li>\u66B4\u9732\u4E00\u4E2A\u63A5\u53E3\u7528\u6765\u63A5\u6536 action</li></ul><blockquote><p>\u4F60\u53EF\u4EE5\u8FD9\u4E48\u7406\u89E3\uFF0C\u4E2D\u95F4\u4EF6\u5176\u5B9E\u5C31\u662F\u6211\u4EEC\u81EA\u5B9A\u4E49\u4E86\u4E00\u4E2A dispatch\uFF0C\u7136\u540E\u8FD9\u4E2A dispatch \u4F1A\u6309\u7167\u6D0B\u8471\u6A21\u578B\u8FDB\u884C pipe</p></blockquote><p><strong>\u6709\u4E2A\u7591\u60D1: \u4E3A\u4EC0\u4E48\u5728 middlewareAPI \u4E2D\uFF0Cdispatch \u4E0D\u662F\u76F4\u63A5\u5199\u6210 store.dispatch, \u800C\u662F\u7528\u7684\u533F\u540D\u51FD\u6570\u7684\u95ED\u5305\u5F15\u7528\uFF1F</strong></p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#676E95;">// \u4E3A\u4EC0\u4E48\u4E0D\u8FD9\u4E48\u5199....</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> middlewareAPI </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">getState</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> store</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">getState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">dispatch</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> store</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispatch</span><span style="color:#A6ACCD;">(action)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p><strong>\u5176\u5B9E\u5199\u6210\u533F\u540D\u51FD\u6570\u7684\u95ED\u5305\u5F15\u7528\u662F\u4E3A\u4E86\u6BCF\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u90FD\u53D6\u7684\u662F\u6700\u65B0\u7684 dispatch</strong>\uFF0C\u5047\u8BBE\u6211\u4EEC\u73B0\u5728\u6267\u884C\u67D0\u4E00\u4E2A\u4E2D\u95F4\u4EF6 m1\uFF0C\u7136\u540E dispatch \u4E86 action1\uFF0C\u5F53\u6B64 action1 \u6267\u884C\u5B8C\u6BD5\uFF0C\u63A5\u7740\u5E94\u8BE5\u6267\u884C\u4E0B\u4E00\u4E2A\u4E2D\u95F4\u4EF6 m2\uFF0C\u5728\u4E0B\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u4E2D\uFF0Cdispatch \u5E94\u5F53\u662F\u6700\u65B0\u7684\u5F15\u7528\uFF0C\u4E0D\u7136\u8FD9\u4E2A action2 \u8D70\u7684\u662F\u6CA1\u6709\u7ECF\u8FC7\u4EFB\u4F55\u4E2D\u95F4\u4EF6\u4FEE\u9970\u7684 store.dispatch\uFF0C\u8FD9\u663E\u7136\u662F\u4E0D\u884C\u7684\u3002\u6240\u4EE5\u8981\u5199\u6210\u533F\u540D\u51FD\u6570\u7684\u95ED\u5305\u5F15\u7528\u3002</p><h3 id="\u7ED3\u5408-rc-redux-model-\u6E90\u7801" tabindex="-1">\u7ED3\u5408 rc-redux-model \u6E90\u7801 <a class="header-anchor" href="#\u7ED3\u5408-rc-redux-model-\u6E90\u7801" aria-hidden="true">#</a></h3><p>\u4E0A\u9762\u770B\u5B8C\u4E4B\u540E\uFF0C\u6700\u4E3A\u91CD\u8981\u7684\u662F\u4F60\u9700\u8981\u77E5\u9053\uFF0C\u4E00\u4E2A\u4E2D\u95F4\u4EF6\u7684\u7EC4\u6210</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> middleware </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">store.dispatch</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> store.getState</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"></span></code></pre></div><p>\u8BB0\u4F4F\u8FD9\u4E00\u70B9\uFF0C\u90A3\u4E48\u63A5\u4E0B\u6765\u5C31\u597D\u529E\u4E86\uFF0C\u56E0\u4E3A\u6211\u4EEC\u505A\u7684\u662F\u4E00\u4E2A redux \u4E2D\u95F4\u4EF6\uFF0C\u5728\u4F7F\u7528\u4E0A\u662F</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">createStore</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">applyMiddleware</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">combineReducers</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">redux</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> models </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./models</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> RcReduxModel </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rc-redux-model</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> reduxModel </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RcReduxModel</span><span style="color:#A6ACCD;">(models)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u{1F449} \u5229\u7528 combineReducers \u628A\u6211\u4EEC\u5199\u7684 reducers \u641E\u8FDB\u53BB</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> reducerList </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">combineReducers</span><span style="color:#A6ACCD;">(reduxModel</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">reducers)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;">// \u{1F449} \u5229\u7528 applyMiddleware \u5C06\u6211\u4EEC\u5199\u7684\u4E2D\u95F4\u4EF6\u641E\u8FDB\u53BB</span></span>
<span class="line"><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createStore</span><span style="color:#A6ACCD;">(reducerList</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">applyMiddleware</span><span style="color:#A6ACCD;">(reduxModel</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">thunk))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>\u63A5\u4E0B\u6765\uFF0C\u6211\u4EEC\u5F00\u59CB\u5199\u4EE3\u7801</p><h4 id="d-\u5F00\u59CB\u5B9E\u73B0-rcreduxmodel-\u7C7B" tabindex="-1">D. \u5F00\u59CB\u5B9E\u73B0 RcReduxModel \u7C7B <a class="header-anchor" href="#d-\u5F00\u59CB\u5B9E\u73B0-rcreduxmodel-\u7C7B" aria-hidden="true">#</a></h4><p>\u4E0B\u9762\u8FD9\u5F20\u56FE\u662F UML \u56FE\uFF0C\u6211\u4EEC\u53EF\u4EE5\u6765\u770B\u4E00\u4E0B\uFF0C\u5171\u6709 3 \u4E2A\u6210\u5458\u53D8\u91CF\u53CA 1 \u4E2A\u79C1\u6709\u65B9\u6CD5\u3002</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b3eed17f36714742975252bdf6bd18f3~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="image.png"></p><ul><li>models\uFF1A\u4F60\u4F20\u8FDB\u6765\u7684 models \u7ECF\u8FC7\u4E00\u7CFB\u5217\u5904\u7406\u4E4B\u540E\u7684\u6700\u7EC8 models</li><li>reducers\uFF1A\u6240\u6709 model \u4E0B\u7684 reducers\uFF0C\u6574\u5408\u5728\u4E00\u8D77\uFF0C\u7528\u4E8E redux.combineReducers</li><li>thunk\uFF1A\u81EA\u5DF1\u5B9E\u73B0\u7684 thunk \u4E2D\u95F4\u4EF6\uFF0C\u5BF9 dispatch \u7684\u589E\u5F3A\uFF0C\u7528\u4E8E redux.applyMiddleware</li><li>start()\uFF1A\u4E3B\u903B\u8F91\uFF0C\u8BE5\u65B9\u6CD5\u4E0B\u7684\u4E3B\u8981\u5DE5\u4F5C\u4E3A <ul><li>\u81EA\u52A8\u4E3A\u6BCF\u4E00\u4E2A state \u503C\u6CE8\u518C action</li><li>\u81EA\u52A8\u6CE8\u518C\u6BCF\u4E00\u4E2A model \u7684 reducers</li><li>\u5B9E\u73B0 dispatch \u5BF9\u4E2D\u95F4\u4EF6\u7684\u589E\u5F3A</li></ul></li></ul><p>\u5728\u6B64\u4E4B\u524D\uFF0C\u6211\u4EEC\u6765\u770B\u4E00\u4E0B\u4E00\u4E2A model \u7684\u7C7B\u578B\u58F0\u660E</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModel</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// \u547D\u540D\u7A7A\u95F4</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">openSeamlessImmutable</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">boolean</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">state</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">action</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">dispatch</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">getState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">currentAction</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">commit</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">call</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">) </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">void</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">reducers</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\u4E0B\u9762\u662F\u4F2A\u4EE3\u7801\uFF0C\u5177\u4F53\u8BF7\u770B\u7EBF\u4E0A\u4EE3\u7801\uFF1A\u{1F449} <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FSugarTurboS%2Frc-redux-model%2Fblob%2Fmaster%2Fcore%2Findex.ts" target="_blank" rel="noreferrer">index.ts</a></p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RcReduxModel</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">models</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModel</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">thunk</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">reducers</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">constructor</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">models</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModel</span><span style="color:#A6ACCD;">[]</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">models</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">reducers</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">thunk</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">start</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">models</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">start</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">models</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModel</span><span style="color:#A6ACCD;">[]</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// step1. \u81EA\u52A8\u4E3A\u6BCF\u4E00\u4E2A state \u90FD\u6CE8\u518C\u4E00\u4E2A action\uFF0C\u5E76\u4E14\u63D0\u4F9B\u9ED8\u8BA4\u4FEE\u6539 state \u7684 action</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// returns \u8FD4\u56DE\u7ECF\u8FC7\u5904\u7406\u4E4B\u540E\u7684 model \u96C6\u5408</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">autoActionAndReducerModel</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">models</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">RModal</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">registerAutoAction</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// step2. \u6BCF\u4E00\u4E2A model \u4E2D\u7684 reducers \u53EA\u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u800C\u5728 redux \u4E2D\uFF0Creducer \u662F\u4E00\u4E2A\u65B9\u6CD5</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u8BE5\u65B9\u6CD5\u7684\u5199\u6CD5\u4E3A\uFF1A(state, action) =&gt; newState; \u6240\u4EE5\u6211\u4EEC\u9700\u8981\u6539\u9020\u6210\u7B26\u5408 redux \u7684\u5199\u6CD5</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u624D\u80FD\u652F\u6301 redux.combineReducers \u53BB\u4F7F\u7528\uFF0C\u8BA9\u6211\u4EEC\u4FEE\u6539\u4E00\u4E0B</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">autoActionAndReducerModel</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forEach</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">RModal</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">reducers</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">namespace</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">registerReducers</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#676E95;">// \u8BE5\u65B9\u6CD5\u8FD4\u56DE\u7684\u662F\u4E00\u4E2A\u51FD\u6570</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// step3. \u4E2D\u95F4\u4EF6\u589E\u5F3A\uFF0C\u6838\u5FC3\u4E4B\u5904\uFF1A(dispatch, getState) =&gt; (next) =&gt; (action) =&gt; {}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u6CE8\u5165\u81EA\u5B9A\u4E49\u7684 callAPI\u3001commit \u7B49\u529F\u80FD\uFF0C\u5177\u4F53\u770B\u4E0B\u9762\u4EE3\u7801</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">thunk</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">middleware</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">autoActionAndReducerModel</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// step4. \u68C0\u6D4B model \u662F\u5426\u6709\u91CD\u590D\uFF0C\u5E76\u5C06\u5904\u7406\u4E4B\u540E\u7684 model \u8D4B\u503C\u7ED9\u6210\u5458\u53D8\u91CF</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">autoActionAndReducerModel</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forEach</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">RModal</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">registerModel</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">models</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\u4E0A\u9762\u5C31\u662F\u6574\u4E2A <code>RcReduxModel</code> \u7C7B\u7684\u6838\u5FC3\u8981\u70B9\uFF0C\u76F8\u6BD4\u7ED3\u5408\u6CE8\u91CA\uFF0C\u5927\u5BB6\u90FD\u80FD\u7406\u89E3\uFF0C\u63A5\u4E0B\u6765\u6211\u5C06\u4E00\u6B65\u6B65\u5E26\u5927\u5BB6\u5B9E\u73B0\u5BF9\u5E94\u7684\u65B9\u6CD5</p><ul><li>registerAutoAction()\uFF1A\u81EA\u52A8\u4E3A\u6BCF\u4E00\u4E2A state \u90FD\u6CE8\u518C\u4E00\u4E2A action\uFF0C\u5E76\u4E14\u63D0\u4F9B\u9ED8\u8BA4\u4FEE\u6539 state \u7684 action</li><li>registerReducers()\uFF1A\u5C06 model \u4E2D\u7684 reducer \u5BF9\u8C61\u53D8\u4E3A (state, action) =&gt; newState \u51FD\u6570</li><li>middleware()\uFF1A\u4E2D\u95F4\u4EF6 (dispatch, getState) =&gt; (next) =&gt; (action) =&gt; {}</li><li>registerModel()\uFF1A\u6240\u6709 model \u7684\u96C6\u5408</li></ul><h4 id="registerautoaction" tabindex="-1">registerAutoAction() <a class="header-anchor" href="#registerautoaction" aria-hidden="true">#</a></h4><p>\u8BE5\u65B9\u6CD5\u63A5\u6536\u7684\u662F\u4E00\u4E2A model\uFF0C\u4E0A\u9762\u8BF4\u4E86\u4E00\u4E2A model \u90FD\u5177\u5907\u4EC0\u4E48\u5C5E\u6027\uFF0C\u5982\u679C\u4F60\u62FF\u5230\u4E86\u4E00\u4E2A model\uFF0C\u4F60\u671F\u671B\u4E3A\u6BCF\u4E00\u4E2A state \u63D0\u4F9B\u5BF9\u5E94\u7684 action\uFF0C\u8BE5\u5982\u4F55\u5B9E\u73B0\u5462\uFF1F</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// \u751F\u6210\u81EA\u52A8\u6CE8\u518C\u4FEE\u6539 state \u7684 action.type</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> generateReducerActionType </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">SET_</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">namespace</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toUpperCase</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">_</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toUpperCase</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">}\`</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModel</span><span style="color:#89DDFF;">):</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModel</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">nextAction</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">nextReducers</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">namespace</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">state</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{},</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">action</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{},</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">reducers</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{},</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">openSeamlessImmutable</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// step1. \u5982\u679C\u6CA1\u6709 state\uFF0C\u90A3\u5C31\u4E0D\u9700\u8981\u81EA\u52A8\u6CE8\u518C\u4E86</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">Object</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">keys</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">state</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// step2. \u5982\u679C\u5B58\u5728 state \u503C\uFF0C\u90A3\u5C31\u904D\u5386 stateKey</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">Object</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">keys</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">state</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forEach</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">stateKey</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">actionTypeToReducer</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">generateReducerActionType</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">namespace</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">stateKey</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// step3. \u7ED9\u6BCF\u4E00\u4E2A state \u90FD\u81EA\u52A8\u751F\u6210\u4E00\u4E2A\u80FD\u4FEE\u6539 state \u7684 action</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">nextAction</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">set</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">stateKey</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">]) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">nextAction</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">set</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">stateKey</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">autoAction</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">actionTypeToReducer</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// step4. \u6CE8\u518C\u4E86 action\uFF0C\u5BF9\u5E94\u7684 reducer \u5E94\u8BE5\u8981\u6709\u4E00\u4E2A action.type \u6620\u5C04\uFF0C\u597D\u4FEE\u6539 state \u503C</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">nextReducers</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">\`\${</span><span style="color:#A6ACCD;">actionTypeToReducer</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">]) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">nextReducers</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">\`\${</span><span style="color:#A6ACCD;">actionTypeToReducer</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">autoReducers</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">stateKey</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">openSeamlessImmutable</span></span>
<span class="line"><span style="color:#F07178;">      )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// step5. \u5982\u679C\u6709\u592A\u591A\u7684 state\uFF0C\u7528\u6237\u8BB0\u4E0D\u4F4F\u6CE8\u518C\u7684 action</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u6240\u4EE5\u8FD9\u91CC\u63D0\u4F9B\u4E24\u4E2A\u9ED8\u8BA4\u7684 action</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">nextAction</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">setStore</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">autoSetStoreAction</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">namespace</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">nextAction</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">setStoreList</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">autoSetStoreListAction</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">namespace</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// step6. \u5982\u679C\u5B58\u5728\u91CD\u590D\uFF0C\u4EE5\u7528\u6237\u5B9A\u4E49\u7684\u4E3A\u4E3B</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">nextAction</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">nextAction</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">action</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">nextReducers</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">nextReducers</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">reducers</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    action</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">nextAction</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    reducers</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">nextReducers</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\u81EA\u52A8\u6CE8\u518C action \u7684\u4EE3\u7801\u5C31\u8FD9\u4E48\u70B9\uFF0C\u4F46\u6838\u5FC3\u5728\u4E8E <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FSugarTurboS%2Frc-redux-model%2Fblob%2Fmaster%2Fcore%2FregisterAutoAction.ts%23L10" target="_blank" rel="noreferrer">autoAction</a> \u7684\u5B9E\u73B0\u548C <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FSugarTurboS%2Frc-redux-model%2Fblob%2Fmaster%2Fcore%2FregisterAutoAction.ts%23L25" target="_blank" rel="noreferrer">autoReducers</a> \u7684\u5B9E\u73B0\u3002</p><p>\u8FD9\u8FB9\u7ED9\u5927\u5BB6\u7559\u4E00\u4E2A\u60AC\u5FF5\uFF0C\u6211\u6015\u4F60\u4EEC\u61D2\u5F97\u53BB\u770B\u6E90\u7801\uFF0C\u6240\u4EE5\u6211\u8FD9\u91CC\u5C31\u4E0D\u8D34\u4EE3\u7801\u4E86\uFF0C\u5B9E\u73B0\u4E5F\u5F88\u7B80\u5355\uFF0C\u5C0F\u4F19\u4F34\u4EEC\u5FEB<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FSugarTurboS%2Frc-redux-model%2Fblob%2Fmaster%2Fcore%2FregisterAutoAction.ts" target="_blank" rel="noreferrer">\u{1F449} \u70B9\u51FB\u8FD9\u91CC</a> \u53BB\u770B\u6E90\u7801\u554A\uFF01</p><h4 id="registerreducers" tabindex="-1">registerReducers() <a class="header-anchor" href="#registerreducers" aria-hidden="true">#</a></h4><p>\u8BE5\u65B9\u6CD5\u63A5\u6536\u7684\u662F\u4E00\u4E2A model\uFF0C\u90A3\u4E48\u6211\u4EEC\u5982\u4F55\u5C06 model.reducers \u5BF9\u8C61\uFF0C\u53D8\u6210\u6211\u4EEC\u671F\u671B\u7684 (state, action) =&gt; newState \u5462\uFF1F</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">registerReducers</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModel</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">namespace</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reducers</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">invariant</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">reducers</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">model&#39;s reducers must be defined, but got undefined</span><span style="color:#89DDFF;">\`</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reducersActionTypes</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Object</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">keys</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">reducers</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">storeState</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">storeAction</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">storeState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reducersActionKeys</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">storeAction</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// step1. \u56E0\u4E3A\u6211\u4EEC\u89C4\u5B9A\u6BCF\u4E00\u4E2A action type \u90FD\u5FC5\u987B\u662F [namespace]/[actionName] \u8FD9\u79CD\u683C\u5F0F</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reducersActionModelName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reducersActionKeys</span><span style="color:#F07178;">[</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reducersActionSelfName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reducersActionKeys</span><span style="color:#F07178;">[</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// step2. \u5982\u679C\u547D\u540D\u7A7A\u95F4\u5BF9\u4E0D\u4E0A\uFF0C\u76F4\u63A5\u8FD4\u56DE\u6570\u636E</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">reducersActionModelName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">namespace</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newState</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// step3. \u5982\u679C\u81EA\u52A8\u6CE8\u518C\u7684 reducer type \u5B58\u5728\u5F53\u524D\u8FD9\u4E2A actionName\uFF0C\u5C31\u4F1A\u89E6\u53D1\u6267\u884C\uFF0C\u5C06 state \u503C\u4FEE\u6539</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// \u5176\u5B9E\u771F\u6B63\u4FEE\u6539\u7684\u5728\u4E8E\u4E0A\u9762\u7684 autoReducers \u65B9\u6CD5\uFF0C\u4E00\u5B9A\u8981\u53BB\u770B\u8FD9\u4E2A\u65B9\u6CD5</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">reducersActionTypes</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">includes</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">reducersActionSelfName</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reducers</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">reducersActionSelfName</span><span style="color:#F07178;">](</span><span style="color:#A6ACCD;">newState</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">storeAction</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">payload</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">newState</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="middleware" tabindex="-1">middleware() <a class="header-anchor" href="#middleware" aria-hidden="true">#</a></h4><p>\u8BE5\u65B9\u6CD5\u63A5\u6536\u7684\u662F\u4E00\u4E2A model \u96C6\u5408\uFF0C\u4E5F\u5C31\u662F <code>RModel[]</code>\uFF0C\u63A5\u4E0B\u6765\u6211\u4EEC\u5982\u4F55\u5B9E\u73B0\u4E00\u4E2A\u4E2D\u95F4\u4EF6\uFF1F</p><p>\u4E2D\u95F4\u4EF6\u7684\u6838\u5FC3\u4E4B\u5904 <code>(dispatch, getState) =&gt; (next) =&gt; (action) =&gt; {}</code></p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> getCurrentModel </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">actionModelName</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">models</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Array</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">RModel</span><span style="color:#89DDFF;">&gt;)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">models</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">findModel</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">models</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">filter</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">RModel</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">namespace</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">actionModelName</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">findModel</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">findModel</span><span style="color:#F07178;">[</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> actionToReducer </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">currentModel</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModal</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">actionModelName</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span></span>
<span class="line"><span style="color:#A6ACCD;">) </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">reducerAction</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">currentModel</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentModel</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">reducers</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">currentModel</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">reducers</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">reducerAction</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">type</span><span style="color:#F07178;">]) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`\${</span><span style="color:#A6ACCD;">actionModelName</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">reducerAction</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">}\`</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          payload</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reducerAction</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">payload</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> callAPI </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">dispatch</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">service</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">params</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{};</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">service</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">params</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">catch</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">params</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">models</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModel</span><span style="color:#A6ACCD;">[]</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">({</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dispatch</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">getState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">next</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// step1. \u56E0\u4E3A\u6211\u4EEC\u89C4\u5B9A\u6BCF\u4E00\u4E2A action type \u90FD\u5FC5\u987B\u662F [namespace]/[actionName] \u8FD9\u79CD\u683C\u5F0F</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">actionKeyTypes</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">invariant</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">actionKeyTypes</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">dispatch action only accept [namespace/actionName], but got </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">actionModelName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">actionKeyTypes</span><span style="color:#F07178;">[</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">actionSelfName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">actionKeyTypes</span><span style="color:#F07178;">[</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// step2. \u5F97\u5230\u5F53\u524D\u7684 model</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentModel</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">getCurrentModel</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">actionModelName</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">models</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">currentModel</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// step3. \u5F53\u524D\u8FD9\u4E2A action \u5BF9\u8C61\u4E2D\u662F\u5426\u5B58\u5728\u5F53\u524D\u53D1\u7684\u8FD9\u4E2A action</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentModelAction</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentModel</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">action</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">?</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentModel</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">action</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">actionSelfName</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">invariant</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">currentModelAction</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">[</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">actionSelfName</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">] does not exist [</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">actionModelName</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">]!</span><span style="color:#89DDFF;">\`</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// step4. \u5982\u679C\u5F53\u524D\u8FD9\u4E2A action \u5B58\u5728\u5E76\u4E14\u662F\u4E00\u4E2A\u51FD\u6570 \uFF08autoAction \u8FD4\u56DE\u7684\u662F\u4E00\u4E2A Function\uFF0C\u6240\u4EE5\u4E00\u5B9A\u8981\u53BB\u770B\u8FD9\u4E2A\u65B9\u6CD5\uFF09</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">currentModelAction</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentModelAction</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">commitActionToReducer</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">actionToReducer</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">currentModel</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">actionModelName</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">next</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;">// step5. \u53D1\u8D77\u4E00\u4E2A \u540C\u6B65 action\uFF0C\u4E5F\u5C31\u662F\u53D1\u4E00\u4E2A\u5230 reducer \u7684 action</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;">// \u5F53 reducer \u63A5\u6536\u5230 action.type \u4E0E\u6211\u4EEC\u53D1\u8FC7\u6765\u7684\u4E00\u81F4\u65F6\uFF0C\u5C31\u8FDB\u884C state \u503C\u4FEE\u6539</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">currentModelAction</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">dispatch</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">getState</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            currentAction</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            commit</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">commitActionToReducer</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            call</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">callAPI</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">dispatch</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// step6. \u6267\u884C\u4E0B\u4E00\u4E2A\u4E2D\u95F4\u4EF6\uFF0C\u56E0\u4E3A applyMiddleware \u53EF\u80FD\u4E0D\u4EC5\u662F\u96C6\u6210\u6211\u4EEC\u7684\u4E2D\u95F4\u4EF6</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// \u610F\u5473\u7740\u5F53\u524D\u8FD9\u4E2A action \u4E5F\u8BB8\u4E0D\u662F\u6211\u4EEC\u6240\u671F\u671B\u7684 action\uFF0C\u6211\u4EEC\u4E0D\u8FD9\u4E2A\u4E2D\u95F4\u4EF6\u4E0D\u5904\u7406\u4E86</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">action</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="registermodel" tabindex="-1">registerModel() <a class="header-anchor" href="#registermodel" aria-hidden="true">#</a></h4><p>\u8BE5\u65B9\u6CD5\u5C31\u662F\u68C0\u6D4B model \u662F\u5426\u6709\u91CD\u590D</p><div class="language-ts"><button class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">registerModel</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModal</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">models</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RModal</span><span style="color:#A6ACCD;">[]</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">invariant</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">namespace</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">model&#39;s namespace is undefined</span><span style="color:#89DDFF;">\`</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">invariant</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">namespace</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">string</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">model&#39;s namespace should be string, but got </span><span style="color:#89DDFF;">\${</span><span style="color:#89DDFF;">typeof</span><span style="color:#A6ACCD;"> model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">namespace</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">duplicateModel</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">models</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">filter</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">mod</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">RModal</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">mod</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">namespace</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">namespace</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">invariant</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">duplicateModel</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">model&#39;s namespace should be unique, but now got the same namespace length = </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">duplicateModel</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">, with the same namespace is </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">namespace</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!this.</span><span style="color:#A6ACCD;">models</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">namespace</span><span style="color:#F07178;">]) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">models</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">namespace</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="\u603B\u7ED3" tabindex="-1">\u603B\u7ED3 <a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a></h4><p>\u4E0A\u8FF0\u5C31\u662F\u6574\u4E2A <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FSugarTurboS%2Frc-redux-model" target="_blank" rel="noreferrer">rc-redux-model</a> \u6838\u5FC3\u4EE3\u7801\uFF0C\u5B9E\u73B0\u4E0D\u96BE\uFF0C\u6211\u8FD8\u662F\u671F\u671B\u5C0F\u4F19\u4F34\u4EEC\u90FD\u80FD\u53BB\u770B\u6E90\u7801\uFF0C\u5F53\u7136\u6211\u7684\u4EE3\u7801\u5199\u7684\u4E5F\u4E0D\u4E00\u5B9A\u662F\u6700\u4F73\u7684\uFF0C\u5E0C\u671B\u80FD\u7ED9\u4F60\u5E26\u6765\u4E00\u4E9B\u601D\u8DEF\u3002</p><p>\u5982\u679C\u4F60\u80FD\u634B\u6E05\u695A\u5E76\u4E14\u770B\u61C2\u6E90\u7801\uFF0C\u90A3\u4E48\u6211\u4EEC\u53EF\u4EE5\u5B9E\u73B0\u4E00\u4E2A\u4F8B\u5982\u8457\u540D\u7684 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FLogRocket%2Fredux-logger" target="_blank" rel="noreferrer">redux-logger</a>\uFF0C\u6211\u4EEC\u7EC3\u624B\u5B9E\u73B0\u5B83\u7684\u7B80\u6613\u7248\u672C\uFF0C\u5B9E\u73B0\u8D77\u6765\u5927\u540C\u5C0F\u5F02\uFF0C\u53EA\u9700\u8981\u5C06\u672A\u4FEE\u6539\u524D\u7684 redux \u548C\u4FEE\u6539\u4E4B\u540E\u7684 redux \u6253\u5370\u51FA\u6765\uFF0C\u518D\u628A\u4FEE\u6539\u7684 action \u6253\u5370\u51FA\u6765\uFF0C\u4E00\u4E2A\u6700\u5C0F\u5316\u7684 redux \u6570\u636E\u6253\u5370\u4E2D\u95F4\u4EF6\u5C31\u5B8C\u6210\u4E86\u3002</p><h2 id="\u6700\u540E" tabindex="-1">\u6700\u540E <a class="header-anchor" href="#\u6700\u540E" aria-hidden="true">#</a></h2><p>\u8BE5\u7BC7\u5E45\u7279\u522B\u957F\uFF0C\u6211\u5F88\u60F3\u62C6\u6210\u4E24\u7BC7\u53BB\u5199\uFF0C\u4F46\u6700\u540E\u60F3\u60F3\u8FD8\u662F\u7B97\u4E86\uFF0C\u8FD9\u7BC7\u6587\u7AE0\u4E3B\u8981\u662F\u4ECE\u6211\u4E3A\u4EC0\u4E48\u8981\u505A\u4E00\u4E2A\u4E2D\u95F4\u4EF6\uFF0C\u5230\u6211\u671F\u671B\u505A\u6210\u600E\u4E48\u6837\uFF0C\u518D\u5230\u505A\u4E4B\u524D\u7684\u77E5\u8BC6\u50A8\u5907\uFF0C\u53CA\u6700\u7EC8\u7684\u505A\u6210\u4EC0\u4E48\u6837\u3002</p><p>\u5E0C\u671B\u6211\u7684\u4E00\u4E9B\u601D\u8003\u548C\u5B9E\u73B0\u80FD\u7ED9\u4F60\u5E26\u6765\u4E00\u4E9B\u6536\u83B7\u3002\u6700\u540E\u5982\u679C\u4F60\u89C9\u5F97\u8BE5\u4E2D\u95F4\u4EF6\u8FD8\u884C\uFF0C\u80FD\u7ED9\u4F60\u4E00\u4E9B\u5E2E\u52A9\uFF0C\u90A3\u6211\u4E0D\u77E5\u5EC9\u803B\u7684\u6C42\u4E2A\u5C0F\u661F\u661F \u2728 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FSugarTurboS%2Frc-redux-model" target="_blank" rel="noreferrer">rc-redux-model</a></p>`,192),e=[o];function c(t,r,F,y,D,A){return a(),n("div",null,e)}const d=s(p,[["render",c]]);export{i as __pageData,d as default};
