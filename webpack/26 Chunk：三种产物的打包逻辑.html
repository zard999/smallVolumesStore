<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>掘金小册子 | 掘金小册子</title>
    <meta name="description" content="自用的掘金小册">
    <link rel="stylesheet" href="/smallVolumesStore/assets/style.77d4fcc5.css">
    <link rel="modulepreload" href="/smallVolumesStore/assets/app.3aab1824.js">
    <link rel="modulepreload" href="/smallVolumesStore/assets/webpack_26 Chunk：三种产物的打包逻辑.md.f186e9e1.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-ca9ccb7e><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-ca9ccb7e data-v-a71a30f1><div class="VPNavBar has-sidebar" data-v-a71a30f1 data-v-a35e6f52><div class="container" data-v-a35e6f52><div class="VPNavBarTitle has-sidebar" data-v-a35e6f52 data-v-d5925166><a class="title" href="/smallVolumesStore/" data-v-d5925166><!--[--><!--]--><!----><!--[-->掘金小册子<!--]--><!--[--><!--]--></a></div><div class="content" data-v-a35e6f52><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-a35e6f52 data-v-f83db6ba><span id="main-nav-aria-label" class="visually-hidden" data-v-f83db6ba>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/smallVolumesStore/webpack/1%20%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86%20Webpack%EF%BC%9A%E6%97%A7%E6%97%B6%E4%BB%A3%E7%9A%84%E7%A0%B4%E5%B1%80%E8%80%85.html" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->Webpack5核心原理与应用实践<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/smallVolumesStore/electron/1.%E5%BC%80%E7%AF%87-%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%E5%92%8C%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.html" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->Electron简历平台实战<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/smallVolumesStore/design/1%20%E5%BC%80%E7%AF%87%EF%BC%9A%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E6%88%90%E9%95%BF%E8%AE%BA.html" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->JavaScript设计模式核心原理与应用实践<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/smallVolumesStore/tsguide/1.%E5%BC%80%E7%AF%87%EF%BC%9A%E7%94%A8%E6%AD%A3%E7%A1%AE%E7%9A%84%E6%96%B9%E5%BC%8F%E5%AD%A6%E4%B9%A0%20TypeScript.html" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->TypeScript全面进阶指南<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-a35e6f52 data-v-a3e7452b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-a3e7452b data-v-968780f1 data-v-086e8519><span class="check" data-v-086e8519><span class="icon" data-v-086e8519><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-968780f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-968780f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-a35e6f52 data-v-e89b88d7 data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6ffb57d3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-6ffb57d3><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><!----><!--[--><!--[--><!----><div class="group" data-v-e89b88d7><div class="item appearance" data-v-e89b88d7><p class="label" data-v-e89b88d7>Appearance</p><div class="appearance-action" data-v-e89b88d7><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-e89b88d7 data-v-968780f1 data-v-086e8519><span class="check" data-v-086e8519><span class="icon" data-v-086e8519><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-968780f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-968780f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a35e6f52 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-ca9ccb7e data-v-aac27d5e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-aac27d5e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-aac27d5e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-aac27d5e>Menu</span></button><a class="top-link" href="#" data-v-aac27d5e> Return to top </a></div><aside class="VPSidebar" data-v-ca9ccb7e data-v-f332cb62><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-f332cb62><span class="visually-hidden" id="sidebar-aria-label" data-v-f332cb62> Sidebar Navigation </span><!--[--><div class="group" data-v-f332cb62><section class="VPSidebarGroup" data-v-f332cb62 data-v-2976c796><div class="title" data-v-2976c796><h2 class="title-text" data-v-2976c796>Webpack5</h2><div class="action" data-v-2976c796><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-2976c796><!--[--><a class="VPLink link link" href="/smallVolumesStore/webpack/1%20%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86%20Webpack%EF%BC%9A%E6%97%A7%E6%97%B6%E4%BB%A3%E7%9A%84%E7%A0%B4%E5%B1%80%E8%80%85.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>1 重新认识 Webpack：旧时代的破局者</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/2%20%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%20Webpack%20%E9%85%8D%E7%BD%AE%E5%BA%95%E5%B1%82%E7%BB%93%E6%9E%84%E9%80%BB%E8%BE%91.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>2 如何理解 Webpack 配置底层结构逻辑</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/3%20%E5%A6%82%E4%BD%95%E5%80%9F%E5%8A%A9%20Babel%20TS%20ESLint%20%E6%9E%84%E5%BB%BA%E7%8E%B0%E4%BB%A3%20JS%20%E5%B7%A5%E7%A8%8B%E7%8E%AF%E5%A2%83%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>3 如何借助 Babel TS ESLint 构建现代 JS 工程环境？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/4%20%E5%A6%82%E4%BD%95%E5%80%9F%E5%8A%A9%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8%E3%80%81PostCSS%20%E7%AD%89%E6%9E%84%E5%BB%BA%E7%8E%B0%E4%BB%A3%20CSS%20%E5%B7%A5%E7%A8%8B%E7%8E%AF%E5%A2%83%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>4 如何借助预处理器、PostCSS 等构建现代 CSS 工程环境？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/5%20%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BA%20Vue%20%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>5 如何搭建 Vue 全栈开发环境？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/6%20%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BA%20React%20%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>6 如何搭建 React 全栈开发环境？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/7%20%E4%BD%BF%E7%94%A8%20Webpack%20%E6%9E%84%E5%BB%BA%20NPM%20Library%20%E7%9A%84%E6%AD%A3%E7%A1%AE%E6%96%B9%E5%BC%8F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>7 使用 Webpack 构建 NPM Library 的正确方式</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/8%20%E4%BD%BF%E7%94%A8%20Webpack%20%E6%9E%84%E5%BB%BA%E5%BE%AE%E5%89%8D%E7%AB%AF%E5%BA%94%E7%94%A8.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>8 使用 Webpack 构建微前端应用</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/9%20%E5%A6%82%E4%BD%95%E5%80%9F%E5%8A%A9%20Webpack%20%E5%BC%80%E5%8F%91%20PWA%E3%80%81Node%E3%80%81Electron%20%E5%BA%94%E7%94%A8%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>9 如何借助 Webpack 开发 PWA、Node、Electron 应用？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/10%20%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%9B%BE%E5%83%8F%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>10 深入理解图像加载原理与最佳实践</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/11%20%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20Webpack%20%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E7%BB%93%E6%9E%84.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>11 深入理解 Webpack 核心配置结构</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/12%20%E6%9E%84%E5%BB%BA%E6%80%A7%E8%83%BD%EF%BC%9A%E5%88%86%E4%BA%AB%207%20%E6%AC%BE%E5%B8%B8%E7%94%A8%E7%9A%84%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>12 构建性能：分享 7 款常用的性能分析工具</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/13%20%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%20Webpack%20%E6%8C%81%E4%B9%85%E5%8C%96%E7%BC%93%E5%AD%98%E5%A4%A7%E5%B9%85%E6%8F%90%E5%8D%87%E6%9E%84%E5%BB%BA%E6%80%A7%E8%83%BD%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>13 如何使用 Webpack 持久化缓存大幅提升构建性能？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/14%20Webpack%20%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C%E6%9E%84%E5%BB%BA%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>14 Webpack 都有哪些实现并行构建的方法？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/15%20%E6%9C%89%E5%93%AA%E4%BA%9B%E5%80%BC%E5%BE%97%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%9E%84%E5%BB%BA%E6%80%A7%E8%83%BD%E6%9E%81%E8%87%B4%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>15 有哪些值得学习的构建性能极致优化技巧？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/16%20%E5%A6%82%E4%BD%95%E6%AD%A3%E7%A1%AE%E4%BD%BF%E7%94%A8%20SplitChunks%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E6%80%A7%E8%83%BD%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>16 如何正确使用 SplitChunks提升应用性能？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/17%20%E4%B8%8D%E6%AD%A2%20Terser%EF%BC%9A%E6%8F%AD%E7%A7%98%E4%BB%A3%E7%A0%81%E5%8E%8B%E7%BC%A9%E7%9A%84%E9%97%A8%E9%97%A8%E9%81%93%E9%81%93.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>17 不止 Terser：揭秘代码压缩的门门道道</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/18%20%E8%BF%98%E6%9C%89%E5%93%AA%E4%BA%9B%E5%80%BC%E5%BE%97%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%BA%94%E7%94%A8%E6%80%A7%E8%83%BD%E6%9E%81%E8%87%B4%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>18 还有哪些值得学习的应用性能极致优化技巧？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/19%20Loader%20%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80%EF%BC%9A%E4%BB%8E%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%AD%A6%E5%88%B0%E7%9A%84%20Loader%20%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>19 Loader 开发基础：从开源项目学到的 Loader 开发技巧</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/20%20Loader%20%E5%BC%80%E5%8F%91%E8%BF%9B%E9%98%B6%EF%BC%9A%E5%A6%82%E4%BD%95%E7%94%A8%E5%A5%BD%20Loader%20%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>20 Loader 开发进阶：如何用好 Loader 扩展开发工具？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/21%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80%EF%BC%9A%E5%AE%9E%E4%BE%8B%E5%89%96%E6%9E%90%E6%8F%92%E4%BB%B6%E5%9F%BA%E6%9C%AC%E5%BD%A2%E6%80%81%E4%B8%8E%E6%9E%B6%E6%9E%84%E9%80%BB%E8%BE%91.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>21 插件开发基础：实例剖析插件基本形态与架构逻辑</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/22%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%BF%9B%E9%98%B6%EF%BC%9A%E5%A6%82%E4%BD%95%E6%8F%90%E5%8D%87%E6%8F%92%E4%BB%B6%E5%81%A5%E5%A3%AE%E6%80%A7%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>22 插件开发进阶：如何提升插件健壮性？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/23%20%E6%8F%92%E4%BB%B6%E6%9E%B6%E6%9E%84%EF%BC%9AHook%20%E4%BD%93%E7%B3%BB%E6%98%AF%E5%A6%82%E4%BD%95%E5%BD%B1%E5%93%8D%20Webpack%20%E6%9E%B6%E6%9E%84%E7%9A%84%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>23 插件架构：Hook 体系是如何影响 Webpack 架构的？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/24%20Init%E3%80%81Make%E3%80%81Seal%EF%BC%9A%E7%9C%9F%E6%AD%A3%E8%AF%BB%E6%87%82%20Webpack%20%E6%A0%B8%E5%BF%83%E6%B5%81%E7%A8%8B.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>24 Init、Make、Seal：真正读懂 Webpack 核心流程</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/25%20Dependency%20Graph%EF%BC%9A%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%E9%97%B4%E4%BE%9D%E8%B5%96%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>25 Dependency Graph：如何管理模块间依赖？</span><!----><!--]--><!----></a><a class="VPLink link link active" href="/smallVolumesStore/webpack/26%20Chunk%EF%BC%9A%E4%B8%89%E7%A7%8D%E4%BA%A7%E7%89%A9%E7%9A%84%E6%89%93%E5%8C%85%E9%80%BB%E8%BE%91.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>26 Chunk：三种产物的打包逻辑</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/27%20Runtime%EF%BC%9A%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91%E6%89%93%E5%8C%85%E5%8F%8A%E8%BF%90%E8%A1%8C%E6%97%B6%E9%80%BB%E8%BE%91.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>27 Runtime：模块编译打包及运行时逻辑</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/28%20Tree-shaking%EF%BC%9A%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E6%97%A0%E7%94%A8%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%87%BA%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>28 Tree-shaking：如何删除无用模块导出？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/29%20Sourcemap%EF%BC%9A%E6%BA%90%E7%A0%81%E6%98%A0%E5%B0%84%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E6%8A%80%E5%B7%A7.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>29 Sourcemap：源码映射原理与应用技巧</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/30%20HMR%EF%BC%9A%E5%A6%82%E4%BD%95%E5%8A%A8%E6%80%81%E6%9B%BF%E6%8D%A2%E9%A1%B5%E9%9D%A2%E4%BB%A3%E7%A0%81%EF%BC%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>30 HMR：如何动态替换页面代码？</span><!----><!--]--><!----></a><a class="VPLink link link" href="/smallVolumesStore/webpack/README.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>总结</span><!----><!--]--><!----></a><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-ca9ccb7e data-v-c95df128><div class="VPDoc has-sidebar has-aside" data-v-c95df128 data-v-f0af2311><div class="container" data-v-f0af2311><div class="aside" data-v-f0af2311><div class="aside-curtain" data-v-f0af2311></div><div class="aside-container" data-v-f0af2311><div class="aside-content" data-v-f0af2311><div class="VPDocAside" data-v-f0af2311 data-v-aea49c31><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-aea49c31 data-v-a3de185c><div class="content" data-v-a3de185c><div class="outline-marker" data-v-a3de185c></div><div class="outline-title" data-v-a3de185c>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-a3de185c><span class="visually-hidden" id="doc-outline-aria-label" data-v-a3de185c> Table of Contents for current page </span><ul class="root" data-v-a3de185c><!--[--><li data-v-a3de185c><a class="outline-link" href="#chunkgraph-构建过程" data-v-a3de185c>ChunkGraph 构建过程</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#chunk-vs-chunkgroup-vs-chunkgraph" data-v-a3de185c>Chunk vs ChunkGroup vs ChunkGraph</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#默认分包规则" data-v-a3de185c>默认分包规则</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#分包规则的问题" data-v-a3de185c>分包规则的问题</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#总结" data-v-a3de185c>总结</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#思考题" data-v-a3de185c>思考题</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-aea49c31></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-f0af2311><div class="content-container" data-v-f0af2311><!--[--><!--]--><main class="main" data-v-f0af2311><div style="position:relative;" class="vp-doc _smallVolumesStore_webpack_26%20Chunk%EF%BC%9A%E4%B8%89%E7%A7%8D%E4%BA%A7%E7%89%A9%E7%9A%84%E6%89%93%E5%8C%85%E9%80%BB%E8%BE%91" data-v-f0af2311><div><p>在上一篇文章《<a href="https://juejin.cn/book/7115598540721618944/section/7119035705153552419" target="_blank" rel="noreferrer">Dependency Graph：如何管理模块间依赖？</a>》中，我们已经详细讲解了「构建」阶段如何从 Entry 开始逐步递归读入、解析模块内容，并最终构建出模块依赖关系图 —— ModuleGraph 对象。本文我们继续往下，讲解在接下来的「封装」阶段，如何根据 ModuleGraph 内容组织 Chunk，并进一步构建出 ChunkGroup、ChunkGraph 依赖关系对象的主流程。</p><p>主流程之外，我们还会详细讲解几个比较模糊的概念：</p><ul><li>Chunk、ChunkGroup、ChunGraph 对象分别是什么？互相之间存在怎样的交互关系？</li><li>Webpack 默认分包规则，以及规则中存在的问题。</li></ul><h2 id="chunkgraph-构建过程" tabindex="-1">ChunkGraph 构建过程 <a class="header-anchor" href="#chunkgraph-构建过程" aria-hidden="true">#</a></h2><p>在 《<a href="https://juejin.cn/book/7115598540721618944/section/7119035873802813475" target="_blank" rel="noreferrer">Init、Make、Seal：真正读懂 Webpack 核心流程</a>》中，我们已经介绍了 Webpack 底层构建逻辑大体上可以划分为：「<strong>初始化、构建、封装</strong>」三个阶段：</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d54599450fe94d0a988ec70214e4ead8~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p>其中，「<strong>构建</strong>」阶段负责分析模块间的依赖关系，建立起模块之间的 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fconcepts%2Fdependency-graph%2F%23root" target="_blank" rel="noreferrer">依赖关系图</a>（ModuleGraph）；紧接着，在「<strong>封装</strong>」阶段根据依赖关系图，将模块分开封装进若干 Chunk 对象中，并将 Chunk 之间的父子依赖关系梳理成 ChunkGraph 与若干 ChunkGroup 对象。</p><p>「封装」阶段最重要的目标就是根据「构建」阶段收集到的 ModuleGraph 关系图构建 ChunkGraph 关系图，这个过程的逻辑比较复杂：</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/92e472f300934c009836445743dd6996~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p>我们简单分析一下这里面几个重要步骤的实现逻辑。</p><p><strong>第一步非常关键：</strong> 调用 <code>seal()</code> 函数后，遍历 <code>entry</code> 配置，为每个入口创建一个空的 <code>Chunk</code> 与 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack%2Fblob%2FHEAD%2Flib%2FEntrypoint.js" target="_blank" rel="noreferrer">EntryPoint</a> 对象（一种特殊的 <code>ChunkGroup</code>），并初步设置好基本的 <code>ChunkGraph</code> 结构关系，为下一步骤做好准备，关键代码：</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Compilation</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">seal</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">callback</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// ...</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">chunkGraphInit</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Map</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 遍历入口模块列表</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dependencies</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">includeDependencies</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">options</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">of</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">entries</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// 为每一个 entry 创建对应的 Chunk 对象</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">chunk</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">addChunk</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">name</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// 为每一个 entry 创建对应的 ChunkGroup 对象</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">entrypoint</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Entrypoint</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">options</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// 关联 Chunk 与 ChunkGroup</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">connectChunkGroupAndChunk</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">entrypoint</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">chunk</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// 遍历 entry Dependency 列表</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dep</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">of</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">...this.</span><span style="color:#A6ACCD;">globalEntry</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dependencies</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">dependencies</span><span style="color:#F07178;">]) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// 为每一个 EntryPoint 关联入口依赖对象，以便下一步从入口依赖开始遍历其它模块</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">entrypoint</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addOrigin</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">null,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">name</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#676E95;">/** </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">type</span><span style="color:#676E95;"> </span><span style="color:#89DDFF;">{</span><span style="color:#FFCB6B;">any</span><span style="color:#89DDFF;">}</span><span style="color:#676E95;"> */</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">dep</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">request</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">module</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">moduleGraph</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getModule</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">dep</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">module</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;">// 在 ChunkGraph 中记录入口模块与 Chunk 关系</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#A6ACCD;">chunkGraph</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">connectChunkAndEntryModule</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">chunk</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">module,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">entrypoint</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#676E95;">// ...</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 调用 buildChunkGraph 方法，开始构建 ChunkGraph</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">buildChunkGraph</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">chunkGraphInit</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// 触发各种优化钩子</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// ...</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>执行完成后，形成如下数据结构：</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/39e2b041b1994fa2b9c4cb92046f1b90~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p>其次，若此时配置了 <code>entry.runtime</code>，Webpack 还会在这个阶段为运行时代码 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack%2Fblob%2FHEAD%2Flib%2FCompilation.js%23L2933-L2934" target="_blank" rel="noreferrer">创建</a> 相应的 Chunk 并直接 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack%2Fblob%2FHEAD%2Flib%2FCompilation.js%23L2937-L2938" target="_blank" rel="noreferrer">分配</a> 给 <code>entry</code> 对应的 <code>ChunkGroup</code>对象。一切准备就绪后调用 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack%2Fblob%2FHEAD%2Flib%2FbuildChunkGraph.js%23L1347-L1348" target="_blank" rel="noreferrer">buildChunkGraph</a> 函数，进入下一步骤。</p><p><strong>第二步：</strong> 在 <code>buildChunkGraph</code> 函数内 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack%2Fblob%2FHEAD%2Flib%2FbuildChunkGraph.js%23L1367-L1368" target="_blank" rel="noreferrer">调用</a> <code>visitModules</code> 函数，遍历 ModuleGraph，将所有 Module 按照依赖关系分配给不同 <code>Chunk</code> 对象；这个过程中若遇到 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fblog%2F2020-10-10-webpack-5-release%2F%23async-modules" target="_blank" rel="noreferrer">异步模块</a>，则为该模块 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack%2Fblob%2FHEAD%2Flib%2FbuildChunkGraph.js%23L740-L742" target="_blank" rel="noreferrer">创建</a>新的 <code>ChunkGroup</code> 与 <code>Chunk</code> 对象，最终形成如下数据结构：</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f065f4c71784477abff7b113eb6dd2bf~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p><strong>第三步：</strong> 在 <code>buildChunkGraph</code> 函数中<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack%2Fblob%2FHEAD%2Flib%2FbuildChunkGraph.js%23L1381-L1382" target="_blank" rel="noreferrer">调用</a> <code>connectChunkGroups</code> 方法，建立 <code>ChunkGroup</code> 之间、<code>Chunk</code> 之间的依赖关系，生成完整的 <code>ChunkGraph</code> 对象，最终形成如下数据结构：</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cd08a1a0b94b4f2d804399c77e916862~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p><strong>第四步：</strong> 在 <code>buildChunkGraph</code> 函数中<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack%2Fblob%2FHEAD%2Flib%2FbuildChunkGraph.js%23L1397-L1398" target="_blank" rel="noreferrer">调用</a> <code>cleanupUnconnectedGroups</code> 方法，清理无效 <code>ChunkGroup</code>，主要起到性能优化作用。</p><p>自上而下经过这四个步骤后，<code>ModuleGraph</code> 中存储的模块将根据模块本身的性质，被分配到 Entry、Async、Runtime 三种不同的 Chunk 对象，并将 Chunk 之间的依赖关系存储到 ChunkGraph 与 ChunkGroup 集合中，后续可在这些对象基础上继续修改分包策略（例如 <code>SplitChunksPlugin</code>），通过重新组织、分配 Module 与 Chunk 对象的归属实现分包优化。</p><h2 id="chunk-vs-chunkgroup-vs-chunkgraph" tabindex="-1">Chunk vs ChunkGroup vs ChunkGraph <a class="header-anchor" href="#chunk-vs-chunkgroup-vs-chunkgraph" aria-hidden="true">#</a></h2><p>上述构建过程涉及 Chunk、ChunkGroup、ChunkGraph 三种关键对象，我们先总结它们的概念与作用，加深理解：</p><ul><li><code>Chunk</code>：Module 用于读入模块内容，记录模块间依赖等；而 Chunk 则根据模块依赖关系合并多个 Module，输出成资产文件（合并、输出产物的逻辑，我们放到下一章讲解）：</li></ul><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2bac3fb532bc406fb16331555c309f9b~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><ul><li><code>ChunkGroup</code>：一个 <code>ChunkGroup</code> 内包含一个或多个 <code>Chunk</code> 对象；<code>ChunkGroup</code> 与 <code>ChunkGroup</code> 之间形成父子依赖关系：</li></ul><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/219d44ad9b4e4d2e9847761f83774d89~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><ul><li><code>ChunkGraph</code>：最后，Webpack 会将 Chunk 之间、ChunkGroup 之间的依赖关系存储到 <code>compilation.chunkGraph</code> 对象中，形成如下类型关系：</li></ul><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/424fe595633d41649a616f2f5076adb4~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><h2 id="默认分包规则" tabindex="-1">默认分包规则 <a class="header-anchor" href="#默认分包规则" aria-hidden="true">#</a></h2><p>综合上述 <code>ChunkGraph</code> 构建流程最终会将 Module 组织成三种不同类型的 Chunk：</p><ul><li>Entry Chunk：同一个 <code>entry</code> 下触达到的模块组织成一个 Chunk；</li><li>Async Chunk：异步模块单独组织为一个 Chunk；</li><li>Runtime Chunk：<code>entry.runtime</code> 不为空时，会将运行时模块单独组织成一个 Chunk。</li></ul><p>这是 Webpack 内置的，在不使用 <code>splitChunks</code> 或其它插件的情况下，模块输入映射到输出的默认规则，是 Webpack 底层关键原理之一，因此有必要展开介绍每一种 Chunk 的具体规则。</p><blockquote><p><strong>Entry Chunk:</strong></p></blockquote><p>先从 Entry Chunk 开始，Webpack 首先会为每一个 <code>entry</code> 创建 <code>Chunk</code> 对象，例如对于如下配置：</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">entry</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">main</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/main</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">home</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/home</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p>遍历 <code>entry</code> 对象属性并创建出 <code>chunk[main]</code> 、<code>chunk[home]</code> 两个对象，此时两个 Chunk 分别包含 <code>main</code> 、<code>home</code> 模块：</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a40257760914ba08783bf2d6a3c1bef~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p>初始化完毕后，Webpack 会根据 <code>ModuleGraph</code> 的依赖关系数据，将 <code>entry</code> 下所触及的所有 Module 塞入 Chunk （发生在 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack%2Fblob%2FHEAD%2Flib%2FbuildChunkGraph.js%23L187-L188" target="_blank" rel="noreferrer">visitModules</a> 方法），比如对于如下文件依赖：</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9d7fbfc917b1416cb1ee86216c3131a0~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p><code>main.js</code> 以同步方式直接或间接引用了 a/b/c/d 四个文件，Webpack 会首先为 <code>main.js</code> 模块创建 Chunk 与 EntryPoint 对象，之后将 a/b/c/d 模块逐步添加到 <code>chunk[main]</code> 中，最终形成：</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/83a4ebfe25b940d5adfb9d04a7507646~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><blockquote><p><strong>Async Chunk:</strong></p></blockquote><p>其次，Webpack 会将每一个异步导入语句（<code>import(xxx)</code> 及 <code>require.ensure</code>）处理为一个单独的 Chunk 对象，并将其子模块都加入这个 Chunk 中 —— 我们称之为 Async Chunk。例如对于下面的例子：</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// index.js</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./sync-a.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./sync-b.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./async-a.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// async-a.js</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./sync-c.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><p>在入口模块 <code>index.js</code> 中，以同步方式引入 sync-a、sync-b；以异步方式引入 async-a 模块；同时，在 async-a 中以同步方式引入 <code>sync-c</code> 模块，形成如下模块依赖关系图：</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/716dba615b424147ad4076ce0a735eb5~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p>此时，Webpack 会为入口 <code>index.js</code>、异步模块 <code>async-a.js</code> 分别创建分包，形成如下 Chunk 结构：</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/892f542a06ae4d31a18130e93b07648a~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p>并且 <code>chunk[index]</code> 与 <code>chunk[async-a]</code> 之间形成了单向依赖关系，Webpack 会将这种依赖关系保存在 <code>ChunkGroup._parents</code> 、<code>ChunkGroup._children</code> 属性中。</p><blockquote><p><strong>Runtime Chunk:</strong></p></blockquote><p>最后，除了 <code>entry</code>、异步模块外，Webpack5 还支持将 Runtime 代码单独抽取为 Chunk。这里说的 Runtime 代码是指一些为了确保打包产物能正常运行，而由 Webpack 注入的一系列基础框架代码，举个例子，常见的 Webpack 打包产物结构如：</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/de9a9cbc02a9452baa1feddcd7c5ef71~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p>上图红框圈出来的一大段代码就是 Webpack 动态生成的运行时代码，编译时，Webpack 会根据业务代码，决定输出哪些支撑特性的运行时代码（基于 <code>Dependency</code> 子类），例如：</p><ul><li>需要 <code>__webpack_require__.f</code>、<code>__webpack_require__.r</code> 等功能实现最起码的模块化支持；</li><li>如果用到动态加载特性，则需要写入 <code>__webpack_require__.e</code> 函数；</li><li>如果用到 Module Federation 特性，则需要写入 <code>__webpack_require__.o</code> 函数；</li><li>等等。</li></ul><p>虽然每段运行时代码可能都很小，但随着特性的增加，最终结果会越来越大，特别对于多 entry 应用，在每个入口都重复打包一份相似的运行时显得有点浪费，为此 Webpack5 提供了 <code>entry.runtime</code> 配置项用于声明如何打包运行时代码。用法上只需在 <code>entry</code> 项中增加字符串形式的 <code>runtime</code> 值，例如：</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">entry</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">index</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">import</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/index</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">runtime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">solid-runtime</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p>在 <code>compilation.seal</code> 函数中，Webpack 首先为 <code>entry</code> 创建 <code>EntryPoint</code>，之后判断 <code>entry</code> 配置中是否带有 <code>runtime</code> 属性，有则创建以 <code>runtime</code> 值为名的 Chunk，因此，上例配置将生成两个 Chunk：<code>chunk[index.js]</code> 、<code>chunk[solid-runtime]</code>，并据此最终产出两个文件：</p><ul><li>入口 index 对应的 <code>index.js</code> 文件；</li><li>运行时配置对应的 <code>solid-runtime.js</code> 文件。</li></ul><p>在多 <code>entry</code> 场景中，只要为每个 <code>entry</code> 都设定相同的 <code>runtime</code> 值，Webpack 运行时代码就会合并写入到同一个 Runtime Chunk 中，最终达成产物性能优化效果。例如对于如下配置：</p><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">entry</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">index</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">import</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/index</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">runtime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">solid-runtime</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">home</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">import</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./src/home</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">runtime</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">solid-runtime</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p>入口 <code>index</code>、<code>home</code> 共享相同的 <code>runtime</code> 值，最终生成三个 Chunk，分别为：</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dcbe4fdd5f2d41d0af0b7fcf990a9bb7~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p>此时入口 <code>chunk[index]</code>、<code>chunk[home]</code> 与运行时 <code>chunk[solid-runtime]</code> 也会形成父子依赖关系。</p><h2 id="分包规则的问题" tabindex="-1">分包规则的问题 <a class="header-anchor" href="#分包规则的问题" aria-hidden="true">#</a></h2><p>默认分包规则最大的问题是无法解决模块重复，如果多个 Chunk 同时包含同一个 Module，那么这个 Module 会被不受限制地重复打包进这些 Chunk。比如假设我们有两个入口 main/index 同时依赖了同一个模块：</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b483355b9b3e4acfb022a2e3aa54d226~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p>默认情况下，Webpack 不会对此做额外处理，只是单纯地将 c 模块同时打包进 main/index 两个 Chunk，最终形成：</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/452ebaf82f7c4df88ae7b5334ff17cba~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?" alt="image.png"></p><p>可以看到 <code>chunk</code> 间互相孤立，模块 c 被重复打包，对最终产物可能造成不必要的性能损耗！</p><p>为了解决这个问题，Webpack 3 引入 <code>CommonChunkPlugin</code> 插件试图将 entry 之间的公共依赖提取成单独的 <code>chunk</code>，但 <code>CommonChunkPlugin</code> 本质上还是基于 Chunk 之间简单的父子关系链实现的，很难推断出提取出的第三个包应该作为 <code>entry</code> 的父 <code>chunk</code> 还是子 <code>chunk</code>，<code>CommonChunkPlugin</code> 统一处理为父 <code>chunk</code>，某些情况下反而对性能造成了不小的负面影响。</p><p>为此，在 Webpack4 之后才专门引入了更复杂的数据结构 —— <code>ChunkGroup</code> 专门实现关系链管理，配合 <code>SplitChunksPlugin</code> 能够更高效、智能地实现<strong>启发式分包。</strong></p><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-hidden="true">#</a></h2><p>综上，「构建」阶段负责根据模块的引用关系构建 ModuleGraph；「封装」阶段则负责根据 ModuleGraph 构建一系列 Chunk 对象，并将 Chunk 之间的依赖关系（异步引用、Runtime）组织为 ChunkGraph —— Chunk 依赖关系图对象。与 ModuleGraph 类似，ChunkGraph 结构的引入也能解耦 Chunk 之间依赖关系的管理逻辑，整体架构逻辑更合理更容易扩展。</p><p>不过，虽然看着很复杂，但「封装」阶段最重要的目标还是在于：确定有多少个 Chunk，以及每一个 Chunk 中包含哪些 Module —— 这些才是真正影响最终打包结果的关键因素。</p><p>针对这一点，我们需要理解 Webpack5 内置的三种分包规则：Entry Chunk、Async Chunk 与 Runtime Chunk，这些是最最原始的分包逻辑，其它插件（例如 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fplugins%2Fsplit-chunks-plugin%2F" target="_blank" rel="noreferrer">splitChunksPlugin</a>）都是在此基础，借助 <code>buildChunkGraph</code> 后触发的各种钩子进一步拆分、合并、优化 Chunk 结构，实现扩展分包效果。</p><h2 id="思考题" tabindex="-1">思考题 <a class="header-anchor" href="#思考题" aria-hidden="true">#</a></h2><p><code>Chunk</code> 一定会且只会生产出一个产物文件吗？为什么？<code>mini-css-extract-plugin</code>、<code>file-loader</code> 这一类能写出额外文件的组件，底层是怎么实现的？</p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-f0af2311 data-v-a54a85bd><!----><div class="prev-next" data-v-a54a85bd><div class="pager" data-v-a54a85bd><a class="pager-link prev" href="/smallVolumesStore/webpack/25%20Dependency%20Graph%EF%BC%9A%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%E9%97%B4%E4%BE%9D%E8%B5%96%EF%BC%9F.html" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Previous page</span><span class="title" data-v-a54a85bd>25 Dependency Graph：如何管理模块间依赖？</span></a></div><div class="has-prev pager" data-v-a54a85bd><a class="pager-link next" href="/smallVolumesStore/webpack/27%20Runtime%EF%BC%9A%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91%E6%89%93%E5%8C%85%E5%8F%8A%E8%BF%90%E8%A1%8C%E6%97%B6%E9%80%BB%E8%BE%91.html" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Next page</span><span class="title" data-v-a54a85bd>27 Runtime：模块编译打包及运行时逻辑</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"design_1 开篇：前端工程师的成长论.md\":\"c8764a45\",\"design_2 设计模式的“道”与“术”.md\":\"72901d28\",\"design_3 创建型：工厂模式·简单工厂——区分“变与不变”.md\":\"f24624a0\",\"design_4 创建型：工厂模式·抽象工厂——理解“开放封闭”.md\":\"264b97e1\",\"design_5 创建型：单例模式——vuex的数据管理哲学.md\":\"ba72fc2c\",\"design_6 创建型：单例模式——面试真题手把手教学.md\":\"7696f662\",\"design_7 创建型：原型模式——谈prototype无小事.md\":\"833e6791\",\"design_8 结构型：装饰器模式——对象装上它，就像开了挂.md\":\"36f35021\",\"design_9 结构型：装饰器模式——深入装饰器原理与优秀案例.md\":\"d7d11902\",\"design_readme.md\":\"79f92adb\",\"design_面试题.md\":\"cb2dc332\",\"electron_1.开篇-技术选型和项目结构.md\":\"13ee01cf\",\"electron_10.业务篇-简历制作之工具条模块与简历模版之间通信.md\":\"264fd22a\",\"electron_11.业务篇-简历制作之数据的录入与展示.md\":\"3b2ed535\",\"electron_12.业务篇-简历制作之导出pdf.md\":\"3798179e\",\"electron_13.支线篇-打包生成第一个桌面应用.md\":\"418dbee8\",\"electron_14.业务篇-简历模版列表实现与侧边栏交互效果.md\":\"e13bac6f\",\"electron_15.业务篇-首页主题换肤功能实现且hooks优化逻辑.md\":\"6cb0686c\",\"electron_16.业务篇-首页主题换肤功能实现且hooks优化逻辑.md\":\"734d7b43\",\"electron_17.业务篇-简历数据存档且自定义存储路径（多窗口）.md\":\"6017c8d0\",\"electron_18.业务篇-思考并补全遗漏的功能细节，整体优化代码，让应用更健壮.md\":\"b6952349\",\"electron_19.优化篇-公共弹窗拆解优化，让职能更加单一.md\":\"414ab07c\",\"electron_2.基础篇-electron初步认识并掌握基础知识.md\":\"6130180c\",\"electron_20定制篇-自定义electron原生应用菜单.md\":\"407ddf40\",\"electron_21.打包篇-应用程序生产环境构建.md\":\"4237e6b3\",\"electron_22.打包篇-生产环境疑难杂症的解决.md\":\"d095ad97\",\"electron_23.打包篇-webpack打包优化.md\":\"411951a2\",\"electron_24.打包篇-electron打包体积 优化.md\":\"589a2e3a\",\"electron_25.到达目的地-应用程序发布.md\":\"43f28b00\",\"electron_26.结尾篇-行而不辍，未来可期.md\":\"ca6c97e5\",\"electron_27.彩蛋篇-webpack基础介绍与两大利器.md\":\"bc2b00ac\",\"electron_28.彩蛋篇-rcreduxmodel中间件开发设计.md\":\"44bc75ca\",\"electron_29.期望篇-可视化自定义独特的简历模版.md\":\"4beb2d28\",\"electron_3.设计篇-需求功能设计与数据存储方案设计.md\":\"3286b1e1\",\"electron_30.问题篇-常见问题解决.md\":\"bb68ec32\",\"electron_4.环境篇-动手搭建我们的简历平台.md\":\"5a17ba51\",\"electron_5.500米里程碑｜环境搭建篇完.md\":\"ffe2dd32\",\"electron_6.业务篇-首页开发，好的印象篇.md\":\"adb3cb28\",\"electron_7.业务篇-如何写我们的redux与file.md\":\"0fb01a99\",\"electron_8.业务篇-简历制作之常用组件设计与简历数据设计.md\":\"06f9f9fb\",\"electron_9.业务篇-简历制作之入口页面开发.md\":\"79d9723a\",\"electron_readme.md\":\"2cd7b8b7\",\"index.md\":\"db300ff7\",\"tsguide_1.开篇：用正确的方式学习 typescript.md\":\"8344fb1b\",\"tsguide_2.工欲善其事：打造最舒适的 typescript 开发环境.md\":\"1f84238e\",\"tsguide_3.进入类型的世界：理解原始类型与对象类型.md\":\"81dc6db3\",\"tsguide_4.掌握字面量类型与枚举，让你的类型再精确一些.md\":\"39b50f14\",\"tsguide_5.函数与 class 中的类型：详解函数重载与面向对象.md\":\"74ba132f\",\"tsguide_6.探秘内置类型：any、unknown、never 与类型断言.md\":\"7265106d\",\"tsguide_7.类型编程好帮手：typescript 类型工具（上）.md\":\"3755d9b5\",\"tsguide_8.类型编程好帮手：typescript 类型工具（下）.md\":\"629d1024\",\"tsguide_9.类型编程基石：typescript 中无处不在的泛型.md\":\"8f23383e\",\"webpack_1 重新认识 webpack：旧时代的破局者.md\":\"81a59551\",\"webpack_10 深入理解图像加载原理与最佳实践.md\":\"e4e3e668\",\"webpack_11 深入理解 webpack 核心配置结构.md\":\"fb227991\",\"webpack_12 构建性能：分享 7 款常用的性能分析工具.md\":\"4755c9fc\",\"webpack_13 如何使用 webpack 持久化缓存大幅提升构建性能？.md\":\"14e017b1\",\"webpack_14 webpack 都有哪些实现并行构建的方法？.md\":\"4df26f6c\",\"webpack_15 有哪些值得学习的构建性能极致优化技巧？.md\":\"a0d6f2ef\",\"webpack_16 如何正确使用 splitchunks提升应用性能？.md\":\"45159af0\",\"webpack_17 不止 terser：揭秘代码压缩的门门道道.md\":\"b9dc582c\",\"webpack_18 还有哪些值得学习的应用性能极致优化技巧？.md\":\"e446f563\",\"webpack_19 loader 开发基础：从开源项目学到的 loader 开发技巧.md\":\"3a87a438\",\"webpack_2 如何理解 webpack 配置底层结构逻辑.md\":\"609e3bd6\",\"webpack_20 loader 开发进阶：如何用好 loader 扩展开发工具？.md\":\"b949dcc6\",\"webpack_21 插件开发基础：实例剖析插件基本形态与架构逻辑.md\":\"541d82ca\",\"webpack_22 插件开发进阶：如何提升插件健壮性？.md\":\"021002da\",\"webpack_23 插件架构：hook 体系是如何影响 webpack 架构的？.md\":\"3693a994\",\"webpack_24 init、make、seal：真正读懂 webpack 核心流程.md\":\"98e0d64f\",\"webpack_25 dependency graph：如何管理模块间依赖？.md\":\"861eda0d\",\"webpack_26 chunk：三种产物的打包逻辑.md\":\"f186e9e1\",\"webpack_27 runtime：模块编译打包及运行时逻辑.md\":\"d7c062b9\",\"webpack_28 tree-shaking：如何删除无用模块导出？.md\":\"7f928fe9\",\"webpack_29 sourcemap：源码映射原理与应用技巧.md\":\"a0c2da6f\",\"webpack_3 如何借助 babel ts eslint 构建现代 js 工程环境？.md\":\"81ccb382\",\"webpack_30 hmr：如何动态替换页面代码？.md\":\"9c7ecd77\",\"webpack_4 如何借助预处理器、postcss 等构建现代 css 工程环境？.md\":\"a05df3e8\",\"webpack_5 如何搭建 vue 全栈开发环境？.md\":\"c1fa4c75\",\"webpack_6 如何搭建 react 全栈开发环境？.md\":\"a687af4a\",\"webpack_7 使用 webpack 构建 npm library 的正确方式.md\":\"26cb2df7\",\"webpack_8 使用 webpack 构建微前端应用.md\":\"7acb73a7\",\"webpack_9 如何借助 webpack 开发 pwa、node、electron 应用？.md\":\"a256b40a\",\"webpack_readme.md\":\"4cfb2f58\"}")</script>
    <script type="module" async src="/smallVolumesStore/assets/app.3aab1824.js"></script>
    
  </body>
</html>